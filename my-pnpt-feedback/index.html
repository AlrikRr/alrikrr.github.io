<!DOCTYPE html><html lang="en-ca"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><title>My PNPT FeedBack - AlrikRr&#x27;s Blog</title><meta name="description" content="Hi! Today I‚Äôm going to share with you my feedback on the PNPT certification that I passed at the beginning&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://alrikrr.github.io/my-pnpt-feedback/"><link rel="alternate" type="application/atom+xml" href="https://alrikrr.github.io/feed.xml"><link rel="alternate" type="application/json" href="https://alrikrr.github.io/feed.json"><meta property="og:title" content="My PNPT FeedBack"><meta property="og:image" content="https://alrikrr.github.io/media/posts/2/my-cert.jpg"><meta property="og:image:width" content="1920"><meta property="og:image:height" content="1095"><meta property="og:site_name" content="AlrikRr's Blog"><meta property="og:description" content="Hi! Today I‚Äôm going to share with you my feedback on the PNPT certification that I passed at the beginning&hellip;"><meta property="og:url" content="https://alrikrr.github.io/my-pnpt-feedback/"><meta property="og:type" content="article"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@alrikrr"><meta name="twitter:title" content="My PNPT FeedBack"><meta name="twitter:description" content="Hi! Today I‚Äôm going to share with you my feedback on the PNPT certification that I passed at the beginning&hellip;"><meta name="twitter:image" content="https://alrikrr.github.io/media/posts/2/my-cert.jpg"><link rel="shortcut icon" href="https://alrikrr.github.io/media/website/android-chrome-192x192.png" type="image/x-icon"><link rel="stylesheet" href="https://alrikrr.github.io/assets/css/fontawesome-all.min.css?v=bbcde81f26378440dac4c3d195714389"><link rel="stylesheet" href="https://alrikrr.github.io/assets/css/style.css?v=9b43267d2b7457feeb36a64550d71700"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://alrikrr.github.io/my-pnpt-feedback/"},"headline":"My PNPT FeedBack","datePublished":"2023-08-15T18:53","dateModified":"2023-08-15T19:11","image":{"@type":"ImageObject","url":"https://alrikrr.github.io/media/posts/2/my-cert.jpg","height":1095,"width":1920},"description":"Hi! Today I‚Äôm going to share with you my feedback on the PNPT certification that I passed at the beginning&hellip;","author":{"@type":"Person","name":"AlrikRr","url":"https://alrikrr.github.io/authors/alrikrr/"},"publisher":{"@type":"Organization","name":"AlrikRr"}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript></head><body class="is-preload"><div id="wrapper"><div id="main"><div class="inner"><header id="header"><a class="logo" href="https://alrikrr.github.io/"><strong>AlrikRr&#x27;s Blog</strong></a><ul class="icons"><li><a href="https://twitter.com/AlrikRr" class="icon brands fa-twitter"><span class="label">Twitter</span></a></li><li><a href="https://www.linkedin.com/in/adrien-lasalle/" class="icon brands fa-linkedin"><span class="label">LinkedIn</span></a></li><li><a href="https://www.youtube.com/channel/UCHUrf2NqybwOFQ6tfYt3zNA" class="icon brands fa-youtube"><span class="label">YouTube</span></a></li></ul></header><article class="post"><header class="main post__header"><time datetime="2023-08-15T18:53" class="post__date">15 August 2023</time><h1>My PNPT FeedBack</h1></header><figure class="image main"><img src="https://alrikrr.github.io/media/posts/2/my-cert.jpg" srcset="https://alrikrr.github.io/media/posts/2/responsive/my-cert-xs.jpg 300w, https://alrikrr.github.io/media/posts/2/responsive/my-cert-sm.jpg 480w, https://alrikrr.github.io/media/posts/2/responsive/my-cert-md.jpg 768w, https://alrikrr.github.io/media/posts/2/responsive/my-cert-lg.jpg 1024w, https://alrikrr.github.io/media/posts/2/responsive/my-cert-xl.jpg 1360w, https://alrikrr.github.io/media/posts/2/responsive/my-cert-xxl.jpg 1600w" sizes="(max-width: 1600px) 100vw, 1600px" loading="lazy" height="1095" width="1920" alt="My PNPT Feedback"><figcaption>Certification PNPT @alrikrr</figcaption></figure><div class="post__inner post__entry"><p>Hi! Today I‚Äôm going to share with you my feedback on the PNPT certification that I passed at the beginning of August 2023 by reviewing the before and during the exam!</p><hr><div class="post__toc"><h3>Table of Contents</h3><ul><li><a href="#my-knowledge">My Knowledge</a></li><li><a href="#mcetoc_1h7tmfdnggn">PNPT &amp; Package Course</a></li><li><a href="#mcetoc_1h7tmfdnggo">Exam Period - 5 Days</a><ul><li><a href="#mcetoc_1h7tmfdnggp">Exam Skills</a></li><li><a href="#mcetoc_1h7tmfdnggq">Exam Package</a></li><li><a href="#mcetoc_1h7tmfdnggr">My Exam</a></li></ul></li><li><a href="#mcetoc_1h7tmfdnggs">Report Period - 2 days</a></li><li><a href="#mcetoc_1h7tmfdnggt">Final Presentation</a></li></ul></div><h1 id="my-knowledge">My Background</h1><p>Before we dive deeper, let me clarify my experience since I see few people talking about their skills before starting the examination. I have 4 years of experience in the field of computer security, with 2 actual years spent as a Pentester. I frequently practice at home, as well as during missions conducting intrusion tests on both internal and external client environments. Moreover, report writing is no longer a mysterious art for me. So, I‚Äôm embarking on this certification with a significant advantage compared to someone new to this field. üõ°Ô∏è</p><figure class="post__image post__image--center"><img loading="lazy" src="https://alrikrr.github.io/media/posts/2/pnpt-2.jpeg" alt="" width="468" height="297" sizes="(max-width: 48em) 100vw, 768px" srcset="https://alrikrr.github.io/media/posts/2/responsive/pnpt-2-xs.jpeg 300w, https://alrikrr.github.io/media/posts/2/responsive/pnpt-2-sm.jpeg 480w, https://alrikrr.github.io/media/posts/2/responsive/pnpt-2-md.jpeg 768w"></figure><h1 id="mcetoc_1h7tmfdnggn">PNPT &amp; Package Course</h1><p>Before purchasing the PNPT courses and voucher, it‚Äôs essential to note that the two exam vouchers do not have an expiration date. The courses are available on the Academic TCM-Security platform, and you‚Äôll be provided with five courses, along with their completion percentages, to give you an idea of what I‚Äôve gone through so far:</p><ul><li>Practical Ethical Hacking - The Complete Course¬†<strong>94%</strong></li><li>Windows Privilege Escalation for Beginners¬†<strong>75%</strong></li><li>Linux Privilege Escalation for Beginners¬†<strong>0%</strong></li><li>Open-Source Intelligence (OSINT) Fundamentals¬†<strong>0%</strong></li><li>External Pentest Playbook¬†<strong>0%</strong></li></ul><p>Additionally, you‚Äôll have access to VODs of Twitch live sessions:</p><ul><li>PNPT Live Training VOD¬†<strong>0%</strong></li></ul><p class="msg msg--warning">Please note that just because I haven‚Äôt finished all the courses doesn‚Äôt mean you should follow suit. As I mentioned earlier, I‚Äôm starting with an advantage.</p><h1 id="mcetoc_1h7tmfdnggo">Exam Period - 5 Days</h1><p>It‚Äôs go-time! You‚Äôve set up your Kali Linux virtual machine, and the countdown has begun!</p><p>You‚Äôve got 5 days to conquer this examination, which means compromising both the external and internal scope, ‚Äúsecuring‚Äù that Domain Admin access to the Domain Controller! All‚Äôs fair in this quest, but just remember, you‚Äôll be following a step-by-step process, just like on a genuine pentesting engagement with a client. So, no DDOS or other disruptions ‚Äì they could spell the end of your exam period!</p><h2 id="mcetoc_1h7tmfdnggp">Exam Skills</h2><p>If I can offer you a few tips on the areas to review and master before taking the exam, here they are:</p><ul><li>OSINT (Open-Source Intelligence)</li><li>Web Application Pentesting</li><li>Pivoting and Proxychains</li><li>Active Directory Pentesting</li><li>Enumeration, Enumeration, ENUMERATION!</li></ul><h2 id="mcetoc_1h7tmfdnggq">Exam Package</h2><p>Regarding your Exam Package, you‚Äôll receive a PDF document containing your scope and instructions from your client. You can also make use of the password wordlists kindly provided by TCM (it‚Äôll make your life easier!).</p><p>Lastly, you‚Äôll receive your VPN access for the lab and the option to revert or stop the lab whenever you want. This won‚Äôt affect the lab‚Äôs configuration or the exam duration.</p><h2 id="mcetoc_1h7tmfdnggr">My Exam</h2><p>As for me, I faced a few challenges during the enumeration phase. I won‚Äôt say more to avoid spoiling anything! The attacks weren‚Äôt overly difficult; they‚Äôre entirely manageable even for beginners if you follow the courses provided by TCM.</p><p>Still, it‚Äôs a lab exam that somewhat mirrors reality, even though everything is designed to give you hints about where to look and what to do without causing too many issues.</p><figure class="post__image post__image--center"><img loading="lazy" src="https://alrikrr.github.io/media/posts/2/meme-0.jpg" alt="Private PNPT joke" width="369" height="298" sizes="(max-width: 48em) 100vw, 768px" srcset="https://alrikrr.github.io/media/posts/2/responsive/meme-0-xs.jpg 300w, https://alrikrr.github.io/media/posts/2/responsive/meme-0-sm.jpg 480w, https://alrikrr.github.io/media/posts/2/responsive/meme-0-md.jpg 768w"></figure><h1 id="mcetoc_1h7tmfdnggs">Report Period - 2 days</h1><p>When it comes to the report writing phase, it‚Äôs also nothing overly complicated. I can only advise you to capture screenshots BEFORE your exam period ends!</p><p>As for what I did, I took notes on the vulnerabilities I discovered and how to exploit them. It‚Äôs important to provide Proof of Concepts (PoCs) but also suggestions for fixing them. Remember, this report is intended for a client, so write it accordingly. Include both the technical and executive aspects.</p><p>My report ended up being a total of 60 pages. I can list the main headings for you to give you an idea of the content, in case it helps inspire you!</p><ul><li>Objective &amp; Context</li><li>Scope</li><li>Server Discovery</li><li>Testing Methodology</li><li>Score &amp; Severity</li><li>Executive Summary</li><li>Vulnerability Summary</li><li>Remediation Summary</li><li>Attack Paths</li><li>Technical Details (Vulnerability Details and PoCs)</li></ul><figure class="post__image post__image--center"><img loading="lazy" src="https://alrikrr.github.io/media/posts/2/meme-1.jpeg" alt="" width="517" height="499" sizes="(max-width: 48em) 100vw, 768px" srcset="https://alrikrr.github.io/media/posts/2/responsive/meme-1-xs.jpeg 300w, https://alrikrr.github.io/media/posts/2/responsive/meme-1-sm.jpeg 480w, https://alrikrr.github.io/media/posts/2/responsive/meme-1-md.jpeg 768w"></figure><h1 id="mcetoc_1h7tmfdnggt">Final Presentation</h1><p>Aside from the technical hiccups at the beginning of the presentation (well, you can‚Äôt really hide the chaos, can you‚Ä¶), it was quite swift ‚Äì no more than 15 minutes ‚Äì with a few questions from the examiner. On my end, I jumped right into presenting the English PDF report (with my French Baguette accent).</p><p>The atmosphere was friendly, with no pressure as long as you‚Äôre confident in your subject! The advantage is that the examiner will give you the final verdict right away, letting you know if you‚Äôve earned your certification or not.</p><figure class="post__image post__image--center"><img loading="lazy" src="https://alrikrr.github.io/media/posts/2/pnpt-3.gif" alt="" width="360" height="225"></figure><figure class="post__image post__image--center"><img loading="lazy" src="https://alrikrr.github.io/media/posts/2/pnpt-4.gif" alt="" width="360" height="202"></figure><div id="post-content" class="post-content"><p>It‚Äôs still a great experience with TCM-Security. If you have any questions, I can answer them without revealing the exam‚Äôs content. As for me, I‚Äôm leaning towards the next certification in Malware Analysis, PJMR!</p></div><div class="row pl-3 pr-3">¬†</div></div><footer class="post__inner post__footer"><p class="post__last-updated">This article was updated on 15 August 2023</p><div class="post__share"><h3>Share post:</h3><a href="https://twitter.com/share?url=https%3A%2F%2Falrikrr.github.io%2Fmy-pnpt-feedback%2F&amp;via=%40AlrikRr&amp;text=My%20PNPT%20FeedBack" class="js-share icon brands fa-twitter" rel="nofollow noopener noreferrer"><span class="label">Twitter</span> </a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Falrikrr.github.io%2Fmy-pnpt-feedback%2F" class="js-share icon brands fa-linkedin" rel="nofollow noopener noreferrer"><span class="label">LinkedIn</span> </a><a href="https://api.whatsapp.com/send?text=My%20PNPT%20FeedBack https%3A%2F%2Falrikrr.github.io%2Fmy-pnpt-feedback%2F" class="js-share icon brands fa-whatsapp" rel="nofollow noopener noreferrer"><span class="label">WhatsApp</span></a></div><div class="post__tag"><ul><li><strong>Tagged in:</strong></li><li><a href="https://alrikrr.github.io/tags/updates/">Updates</a></li></ul></div><div class="post__bio"><img src="https://alrikrr.github.io/media/website/1675479739617.jpeg" loading="lazy" height="697" width="697" alt="AlrikRr"><div><h3><a href="https://alrikrr.github.io/authors/alrikrr/" class="invert" rel="author">AlrikRr</a></h3><p>Former Firefighter üöí, I decided to follow my passion in computer security and pursue my studies in this domain. After a few moves all over France üá´üá∑ and 4 months of study in Warsaw, Poland, I was able to join Canada üá®üá¶ and start a new life!<br>üì® Feel free to contact me to talk cyber over coffee ‚òïÔ∏è !</p><ul><li class="align-left">My Github Account: <a href="https://github.com/AlrikRr" title="My Github" target="_blank" rel="noopener">AlrikRr</a></li><li class="align-left">My Twitter Account: <a href="https://twitter.com/AlrikRr" title="My Twitter" target="_blank" rel="noopener">AlrikRr</a></li><li class="align-left">Infosec.Exchange: <a href="https://infosec.exchange/@AlrikRr" title="My Mastodon Account" target="_blank" rel="noopener">@AlrikRr</a></li></ul></div></div></footer></article></div></div><div id="sidebar"><div class="inner"><nav id="menu"><header class="major"><h2>Menu</h2></header><ul><li><a href="https://alrikrr.github.io/" target="_self">Home üè†</a></li><li><a href="https://alrikrr.github.io/authors/alrikrr/" target="_self">About me üë∫</a></li><li class="has-submenu"><a href="https://alrikrr.github.io/tags/" target="_self" aria-haspopup="true" class="opener">Categories üóÇÔ∏è</a><ul class="submenu level-2" aria-hidden="true"><li><a href="https://alrikrr.github.io/tags/" target="_self">All</a></li><li><a href="https://alrikrr.github.io/tags/updates/" target="_self">Personal Updates</a></li><li><a href="https://alrikrr.github.io/tags/flipperzero/" target="_self">FlipperZero</a></li><li><a href="https://alrikrr.github.io/tags/8-bits-computer/" target="_self">8 Bits Computer</a></li><li><a href="https://alrikrr.github.io/tags/iot-hacking/" target="_self">IoT Hacking</a></li><li><a href="https://alrikrr.github.io/tags/reverse-engineering/" target="_self">Reverse Engineering</a></li><li><a href="https://alrikrr.github.io/tags/malware/" target="_self">Malware</a></li><li><a href="https://alrikrr.github.io/tags/raspberrypi/" target="_self">RaspberryPi</a></li><li><a href="https://alrikrr.github.io/tags/pentesting/" target="_self">Pentesting</a></li><li><a href="https://alrikrr.github.io/tags/write-up/" target="_self">Write Up</a></li></ul></li><li class="has-submenu"><span aria-haspopup="true" class="opener">Projects üöß</span><ul class="submenu level-2" aria-hidden="true"><li><a href="https://github.com/AlrikRr/Cisco-Smart-Exploit" target="_blank">Cisco-Smart-Exploit</a></li><li><a href="https://github.com/AlrikRr/Forensic-Extract" target="_blank">Forensic-Extract</a></li><li><a href="https://github.com/AlrikRr/USBGuardian" target="_self">USBGuardian (fork)</a></li><li><a href="https://github.com/AlrikRr/DFIR-ExtracTux" target="_blank">DFIR-Extractux</a></li></ul></li><li><a href="https://www.buymeacoffee.com/AlrikRr" target="_blank">Buy me a beer üç∫</a></li></ul></nav><section><header class="major"><h2>Get in touch</h2></header><p>üì® Feel free to contact me to talk cyber over coffee ‚òïÔ∏è !<br><br>=== Area of expertise ===<br>üìç Web Application Pentest (OWASP)<br>üìç Internal Active Directory &amp; SCADA Pentest<br>üìç Pentest Cloud Azure<br>üìç Python &amp; PowerShell development<br>üìç Malware Analysis</p><ul class="contact"><li class="icon solid fa-envelope">adrienlasalle[dot]pro[at]gmail[dot]com</li><li class="icon solid fa-home">Montr√©al, Qc üá®üá¶</li></ul></section><footer id="footer"><p class="copyright">¬© AlrikRr 2023 - All rights reserved</p></footer></div></div></div><script src="https://alrikrr.github.io/assets/js/jquery.min.js?v=7c14a783dfeb3d238ccd3edd840d82ee"></script><script src="https://alrikrr.github.io/assets/js/browser.min.js?v=c07298dd19048a8a69ad97e754dfe8d0"></script><script src="https://alrikrr.github.io/assets/js/breakpoints.min.js?v=81a479eb099e3b187613943b085923b8"></script><script src="https://alrikrr.github.io/assets/js/util.min.js?v=cbdaf7c20ac2883c77ae23acfbabd47e"></script><script src="https://alrikrr.github.io/assets/js/main.min.js?v=08add7f6d435054ad38ec38d7cf8be40"></script><script>var images=document.querySelectorAll("img[loading]");for(var i=0;i<images.length;i++){if(images[i].complete){images[i].classList.add("is-loaded")}else{images[i].addEventListener("load",function(){this.classList.add("is-loaded")},false)}};</script><div class="pcb" data-behaviour="badge" data-behaviour-link="#cookie-settings" data-revision="1" data-config-ttl="90" data-debug-mode="false"><div role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="pcb-title" aria-describedby="pcb-txt" class="pcb__banner"><div class="pcb__inner"><div id="pcb-title" role="heading" aria-level="2" class="pcb__title">This website uses cookies</div><div id="pcb-txt" class="pcb__txt">Select which cookies to opt-in to via the checkboxes below; our website uses cookies to examine site traffic and user activity while on our site, for marketing, and to provide social media functionality. <a href="#not-specified">More details...</a></div><div class="pcb__buttons"><button type="button" class="pcb__btn pcb__btn--link pcb__btn--configure" aria-haspopup="dialog">Manage preferences</button> <button type="button" class="pcb__btn pcb__btn--reject">Reject</button> <button type="button" class="pcb__btn pcb__btn--solid pcb__btn--accept">Accept all</button></div></div></div><div class="pcb__popup" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="pcb-popup-title"><div class="pcb__popup__wrapper"><div class="pcb__inner pcb__popup__inner"><div class="pcb__popup__heading"><div id="pcb-popup-title" role="heading" aria-level="2" class="pcb__title">Cookie settings</div><button class="pcb__popup__close" aria-label="Close"></button></div><div class="pcb__popup__content"><div class="pcb__txt pcb__popup__txt">We use cookies to enhance your browsing experience, serve personalized ads or content, and analyze our traffic. By clicking "Accept All", you consent to our use of cookies. <a href="#not-specified">More details...</a></div><ul class="pcb__groups"><li class="pcb__group"><details><summary class="pcb__group__title no-desc">Required</summary></details><div class="pcb__popup__switch is-checked"><input type="checkbox" data-group-name="" id="pcb-group-0" checked="checked"> <label for="pcb-group-0">Required</label></div></li></ul></div><div class="pcb__buttons pcb__popup__buttons"><button type="button" class="pcb__btn pcb__btn--solid pcb__btn--accept">Accept all</button> <button type="button" class="pcb__btn pcb__btn--reject">Reject all</button> <button type="button" class="pcb__btn pcb__btn--save">Save settings</button></div></div></div></div><div class="pcb__overlay" aria-hidden="true"></div><button class="pcb__badge" aria-label="Cookie Policy" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" width="40" height="40" viewBox="0 0 23 23" fill="currentColor"><path d="M21.41 12.71c-.08-.01-.15 0-.22 0h-.03c-.03 0-.05 0-.08.01-.07 0-.13.01-.19.04-.52.21-1.44.19-2.02-.22-.44-.31-.65-.83-.62-1.53a.758.758 0 0 0-.27-.61.73.73 0 0 0-.65-.14c-1.98.51-3.49.23-4.26-.78-.82-1.08-.73-2.89.24-4.49.14-.23.14-.52 0-.75a.756.756 0 0 0-.67-.36c-.64.03-1.11-.1-1.31-.35-.19-.26-.13-.71-.01-1.29.04-.18.06-.38.03-.59-.05-.4-.4-.7-.81-.66C5.1 1.54 1 6.04 1 11.48 1 17.28 5.75 22 11.6 22c5.02 0 9.39-3.54 10.39-8.42.08-.4-.18-.78-.58-.87Zm-9.81 7.82c-5.03 0-9.12-4.06-9.12-9.06 0-4.34 3.05-8 7.25-8.86-.08.7.05 1.33.42 1.81.24.32.66.67 1.38.84-.76 1.86-.65 3.78.36 5.11.61.81 2.03 2 4.95 1.51.18.96.71 1.54 1.18 1.87.62.43 1.38.62 2.1.62.05 0 .09 0 .13-.01-1.23 3.64-4.7 6.18-8.64 6.18ZM13 17c0 .55-.45 1-1 1s-1-.45-1-1 .45-1 1-1 1 .45 1 1Zm5.29-12.3a.99.99 0 0 1-.29-.71c0-.55.45-.99 1-.99a1 1 0 0 1 .71.3c.19.19.29.44.29.71 0 .55-.45.99-1 .99a1 1 0 0 1-.71-.3ZM9 13.5c0 .83-.67 1.5-1.5 1.5S6 14.33 6 13.5 6.67 12 7.5 12s1.5.67 1.5 1.5Zm3.25.81a.744.744 0 0 1-.06-1.05c.28-.32.75-.34 1.05-.06.31.28.33.75.05 1.06-.15.16-.35.25-.56.25-.18 0-.36-.06-.5-.19ZM8.68 7.26c.41.37.44 1 .07 1.41-.2.22-.47.33-.75.33a.96.96 0 0 1-.67-.26c-.41-.37-.44-1-.07-1.41.37-.42 1-.45 1.41-.08Zm11.48 1.88c.18-.19.52-.19.7 0 .05.04.09.1.11.16.03.06.04.12.04.19 0 .13-.05.26-.15.35-.09.1-.22.15-.35.15s-.26-.05-.35-.15a.355.355 0 0 1-.11-.16.433.433 0 0 1-.04-.19c0-.13.05-.26.15-.35Zm-4.93-1.86a.75.75 0 1 1 1.059-1.06.75.75 0 0 1-1.059 1.06Z"/></svg></button></div><script>(function(win) {
    if (!document.querySelector('.pcb')) {
        return;
    }

    var cbConfig = {
        behaviour: document.querySelector('.pcb').getAttribute('data-behaviour'),
        behaviourLink: document.querySelector('.pcb').getAttribute('data-behaviour-link'),
        revision: document.querySelector('.pcb').getAttribute('data-revision'),
        configTTL: parseInt(document.querySelector('.pcb').getAttribute('data-config-ttl'), 10),
        debugMode: document.querySelector('.pcb').getAttribute('data-debug-mode') === 'true',
        initialState: null,
        previouslyAccepted: []
    };

    var cbUI = {
        wrapper: document.querySelector('.pcb'),
        banner: {
            element: null,
            btnAccept: null,
            btnReject: null,
            btnConfigure: null
        },
        popup: {
            element: null,
            btnClose: null,
            btnSave: null,
            btnAccept: null,
            btnReject: null,
            checkboxes: null,
        },
        overlay: null,
        badge: null,
        blockedScripts: document.querySelectorAll('script[type^="gdpr-blocker/"]'),
        triggerLinks: cbConfig.behaviourLink ? document.querySelectorAll('a[href*="' + cbConfig.behaviourLink + '"]') : null
    };

    function initUI () {
        // setup banner elements
        cbUI.banner.element = cbUI.wrapper.querySelector('.pcb__banner');
        cbUI.banner.btnAccept = cbUI.banner.element.querySelector('.pcb__btn--accept');
        cbUI.banner.btnReject = cbUI.banner.element.querySelector('.pcb__btn--reject');
        cbUI.banner.btnConfigure = cbUI.banner.element.querySelector('.pcb__btn--configure');

        // setup popup elements
        if (cbUI.wrapper.querySelector('.pcb__popup')) {
            cbUI.popup.element = cbUI.wrapper.querySelector('.pcb__popup');
            cbUI.popup.btnClose = cbUI.wrapper.querySelector('.pcb__popup__close');
            cbUI.popup.btnSave = cbUI.popup.element.querySelector('.pcb__btn--save');
            cbUI.popup.btnAccept = cbUI.popup.element.querySelector('.pcb__btn--accept');
            cbUI.popup.btnReject = cbUI.popup.element.querySelector('.pcb__btn--reject');
            cbUI.popup.checkboxes = cbUI.popup.element.querySelector('input[type="checkbox"]');
            // setup overlay
            cbUI.overlay = cbUI.wrapper.querySelector('.pcb__overlay');
        }

        cbUI.badge = cbUI.wrapper.querySelector('.pcb__badge');

        if (cbConfig.behaviour.indexOf('link') > -1) {
            for (var i = 0; i < cbUI.triggerLinks.length; i++) {
                cbUI.triggerLinks[i].addEventListener('click', function(e) {
                    e.preventDefault();
                    showBannerOrPopup();
                });
            }
        }
    }

    function initState () {
        var lsKeyName = getConfigName();
        var currentConfig = localStorage.getItem(lsKeyName);
        var configIsFresh = checkIfConfigIsFresh();

        if (!configIsFresh || currentConfig === null) {
            if (cbConfig.debugMode) {
                console.log('üç™ Config not found, or configuration expired');
            }

            showBanner();
        } else if (typeof currentConfig === 'string') {
            if (cbConfig.debugMode) {
                console.log('üç™ Config founded');
            }

            showBadge();

            if (cbUI.popup.element) {
                var allowedGroups = currentConfig.split(',');
                var checkedCheckboxes = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');

                for (var j = 0; j < checkedCheckboxes.length; j++) {
                    var name = checkedCheckboxes[j].getAttribute('data-group-name');

                    if (name && name !== '-' && allowedGroups.indexOf(name) === -1) {
                        checkedCheckboxes[j].checked = false;
                    }
                }

                for (var i = 0; i < allowedGroups.length; i++) {
                    var checkbox = cbUI.popup.element.querySelector('input[type="checkbox"][data-group-name="' + allowedGroups[i] + '"]');

                    if (checkbox) {
                        checkbox.checked = true;
                    }

                    allowCookieGroup(allowedGroups[i]);
                }
            }
        }

        setTimeout(function () {
            cbConfig.initialState = getInitialStateOfConsents();
        }, 0);
    }

    function checkIfConfigIsFresh () {
        var lastConfigSave = localStorage.getItem('publii-gdpr-cookies-config-save-date');

        if (lastConfigSave === null) {
            return false;
        }

        lastConfigSave = parseInt(lastConfigSave, 10);

        if (lastConfigSave === 0) {
            return true;
        }

        if (+new Date() - lastConfigSave < cbConfig.configTTL * 24 * 60 * 60 * 1000) {
            return true;
        }

        return false;
    }

    function initBannerEvents () {
        cbUI.banner.btnAccept.addEventListener('click', function (e) {
            e.preventDefault();
            acceptAllCookies('banner');
            showBadge();
        }, false);

        if (cbUI.banner.btnReject) {
            cbUI.banner.btnReject.addEventListener('click', function (e) {
                e.preventDefault();
                rejectAllCookies();
                showBadge();
            }, false);
        }

        if (cbUI.banner.btnConfigure) {
            cbUI.banner.btnConfigure.addEventListener('click', function (e) {
                e.preventDefault();
                hideBanner();
                showAdvancedPopup();
                showBadge();
            }, false);
        }
    }

    function initPopupEvents () {
        if (!cbUI.popup.element) {
            return;
        }

        cbUI.overlay.addEventListener('click', function (e) {
            hideAdvancedPopup();
        }, false);

        cbUI.popup.element.addEventListener('click', function (e) {
            e.stopPropagation();
        }, false);

        cbUI.popup.btnAccept.addEventListener('click', function (e) {
            e.preventDefault();
            acceptAllCookies('popup');
        }, false);

        cbUI.popup.btnReject.addEventListener('click', function (e) {
            e.preventDefault();
            rejectAllCookies();
        }, false);

        cbUI.popup.btnSave.addEventListener('click', function (e) {
            e.preventDefault();
            saveConfiguration();
        }, false);

        cbUI.popup.btnClose.addEventListener('click', function (e) {
            e.preventDefault();
            hideAdvancedPopup();
        }, false);
    }

    function initBadgeEvents () {
        if (!cbUI.badge) {
            return;
        }

        cbUI.badge.addEventListener('click', function (e) {
            showBannerOrPopup();
        }, false);
    }

    initUI();
    initState();
    initBannerEvents();
    initPopupEvents();
    initBadgeEvents();

    /**
     * API
     */
    function addScript (src, inline) {
        var newScript = document.createElement('script');

        if (src) {
            newScript.setAttribute('src', src);
        }

        if (inline) {
            newScript.text = inline;
        }

        document.body.appendChild(newScript);
    }

    function allowCookieGroup (allowedGroup) {
        var scripts = document.querySelectorAll('script[type="gdpr-blocker/' + allowedGroup + '"]');
        cbConfig.previouslyAccepted.push(allowedGroup);
    
        for (var j = 0; j < scripts.length; j++) {
            addScript(scripts[j].src, scripts[j].text);
        }

        var groupEvent = new Event('publii-cookie-banner-unblock-' + allowedGroup);
        document.body.dispatchEvent(groupEvent);
        unlockEmbeds(allowedGroup);

        if (cbConfig.debugMode) {
            console.log('üç™ Allowed group: ' + allowedGroup);
        }
    }

    function showBannerOrPopup () {
        if (cbUI.popup.element) {
            showAdvancedPopup();
        } else {
            showBanner();
        }
    }

    function showAdvancedPopup () {
        cbUI.popup.element.classList.add('is-visible');
        cbUI.overlay.classList.add('is-visible');
        cbUI.popup.element.setAttribute('aria-hidden', 'false');
        cbUI.overlay.setAttribute('aria-hidden', 'false');
    }

    function hideAdvancedPopup () {
        cbUI.popup.element.classList.remove('is-visible');
        cbUI.overlay.classList.remove('is-visible');
        cbUI.popup.element.setAttribute('aria-hidden', 'true');
        cbUI.overlay.setAttribute('aria-hidden', 'true');
    }

    function showBanner () {
        cbUI.banner.element.classList.add('is-visible');
        cbUI.banner.element.setAttribute('aria-hidden', 'false');
    }

    function hideBanner () {
        cbUI.banner.element.classList.remove('is-visible');
        cbUI.banner.element.setAttribute('aria-hidden', 'true');
    }

    function showBadge () {
        if (!cbUI.badge) {
            return;
        }

        cbUI.badge.classList.add('is-visible');
        cbUI.badge.setAttribute('aria-hidden', 'false');
    }

    function getConfigName () {
        var lsKeyName = 'publii-gdpr-allowed-cookies';

        if (cbConfig.revision) {
            lsKeyName = lsKeyName + '-v' + parseInt(cbConfig.revision, 10);
        }

        return lsKeyName;
    }

    function storeConfiguration (allowedGroups) {
        var lsKeyName = getConfigName();
        var dataToStore = allowedGroups.join(',');
        localStorage.setItem(lsKeyName, dataToStore);

        if (cbConfig.configTTL === 0) {
            localStorage.setItem('publii-gdpr-cookies-config-save-date', 0);

            if (cbConfig.debugMode) {
                console.log('üç™ Store never expiring configuration');
            }
        } else {
            localStorage.setItem('publii-gdpr-cookies-config-save-date', +new Date());
        }
    }

    function getInitialStateOfConsents () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        if (cbConfig.debugMode) {
            console.log('üç™ Initial state: ' + groups.join(', '));
        }

        return groups;
    }

    function getCurrentStateOfConsents () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        if (cbConfig.debugMode) {
            console.log('üç™ State to save: ' + groups.join(', '));
        }

        return groups;
    }

    function getAllGroups () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        return groups;
    }

    function acceptAllCookies (source) {
        var groupsToAccept = getAllGroups();
        storeConfiguration(groupsToAccept);

        for (var i = 0; i < groupsToAccept.length; i++) {
            var group = groupsToAccept[i];

            if (cbConfig.initialState.indexOf(group) > -1 || cbConfig.previouslyAccepted.indexOf(group) > -1) {
                if (cbConfig.debugMode) {
                    console.log('üç™ Skip previously activated group: ' + group);
                }

                continue;
            }

            allowCookieGroup(group);
        }

        if (cbUI.popup.element) {
            var checkboxesToCheck = cbUI.popup.element.querySelectorAll('input[type="checkbox"]');

            for (var j = 0; j < checkboxesToCheck.length; j++) {
                checkboxesToCheck[j].checked = true;
            }
        }

        if (cbConfig.debugMode) {
            console.log('üç™ Accept all cookies: ', groupsToAccept.join(', '));
        }

        if (source === 'popup') {
            hideAdvancedPopup();
        } else if (source === 'banner') {
            hideBanner();
        }
    }

    function rejectAllCookies () {
        if (cbConfig.debugMode) {
            console.log('üç™ Reject all cookies');
        }

        storeConfiguration([]);
        setTimeout(function () {
            window.location.reload();
        }, 100);
    }

    function saveConfiguration () {
        var groupsToAccept = getCurrentStateOfConsents();
        storeConfiguration(groupsToAccept);

        if (cbConfig.debugMode) {
            console.log('üç™ Save new config: ', groupsToAccept.join(', '));
        }

        if (reloadIsNeeded(groupsToAccept)) {
            setTimeout(function () {
                window.location.reload();
            }, 100);
            return;
        }

        for (var i = 0; i < groupsToAccept.length; i++) {
            var group = groupsToAccept[i];

            if (cbConfig.initialState.indexOf(group) > -1 || cbConfig.previouslyAccepted.indexOf(group) > -1) {
                if (cbConfig.debugMode) {
                    console.log('üç™ Skip previously activated group: ' + group);
                }

                continue;
            }

            allowCookieGroup(group);
        }

        hideAdvancedPopup();
    }

    function reloadIsNeeded (groupsToAccept) {
        // check if user rejected consent for initial groups
        var initialGroups = cbConfig.initialState;
        var previouslyAcceptedGroups = cbConfig.previouslyAccepted;
        var groupsToCheck = initialGroups.concat(previouslyAcceptedGroups);

        for (var i = 0; i < groupsToCheck.length; i++) {
            var groupToCheck = groupsToCheck[i];

            if (groupsToAccept.indexOf(groupToCheck) === -1) {
                if (cbConfig.debugMode) {
                    console.log('üç™ Reload is needed due lack of: ', groupToCheck);
                }

                return true;
            }
        }

        return false;
    }

    function unlockEmbeds (cookieGroup) {
        var iframesToUnlock = document.querySelectorAll('.pec-wrapper[data-consent-group-id="' + cookieGroup + '"]');

        for (var i = 0; i < iframesToUnlock.length; i++) {
            var iframeWrapper = iframesToUnlock[i];
            iframeWrapper.querySelector('.pec-overlay').classList.remove('is-active');
            iframeWrapper.querySelector('.pec-overlay').setAttribute('aria-hidden', 'true');
            var iframe = iframeWrapper.querySelector('iframe');
            iframe.setAttribute('src', iframe.getAttribute('data-consent-src'));
        }
    }

    win.publiiEmbedConsentGiven = function (cookieGroup) {
        // it will unlock embeds
        allowCookieGroup(cookieGroup);

        var checkbox = cbUI.popup.element.querySelector('input[type="checkbox"][data-group-name="' + cookieGroup + '"]');

        if (checkbox) {
            checkbox.checked = true;
        }

        var groupsToAccept = getCurrentStateOfConsents();
        storeConfiguration(groupsToAccept);

        if (cbConfig.debugMode) {
            console.log('üç™ Save new config: ', groupsToAccept.join(', '));
        }
    }
})(window);</script></body></html>