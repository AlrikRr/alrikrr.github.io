<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xmlns:media="http://search.yahoo.com/mrss/">
    <title>AlrikRr&#x27;s Blog</title>
    <link href="https://alrikrr.github.io/feed.xml" rel="self" />
    <link href="https://alrikrr.github.io" />
    <updated>2023-09-13T18:11:28-04:00</updated>
    <author>
        <name>AlrikRr</name>
    </author>
    <id>https://alrikrr.github.io</id>

    <entry>
        <title>Thinkpad T470 - Fingerprint Sensor Setup</title>
        <author>
            <name>AlrikRr</name>
        </author>
        <link href="https://alrikrr.github.io/thinkpad-t470-fingerprint-working-linux/"/>
        <id>https://alrikrr.github.io/thinkpad-t470-fingerprint-working-linux/</id>
        <media:content url="https://alrikrr.github.io/media/posts/32/linux-banner.jpg" medium="image" />
            <category term="Linux"/>

        <updated>2023-09-13T18:11:28-04:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://alrikrr.github.io/media/posts/32/linux-banner.jpg" alt="" />
                    Hello everyone, today's tutorial can be helpful for those who struggle with using and getting the fingerprint device to work&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <p><img src="https://alrikrr.github.io/media/posts/32/linux-banner.jpg" class="type:primaryImage" alt="" /></p>
                <p>Hello everyone, today's tutorial can be helpful for those who struggle with using and getting the fingerprint device to work on their Thinkpad when running a Linux system!<br><br>On my end, I'm using a<strong> Thinkpad T470 </strong>with a brand new SSD, and I've got <strong>PopOs</strong> installed ‚Äì it's running like a charm!</p>
<p>Most of the commands can be found using the python-validity github repo right there</p>
<ul>
<li><a href="https://github.com/uunicorn/python-validity" target="_blank" rel="noopener noreferrer">python-validity github link</a></li>
</ul>
<h1>Update apt repo</h1>
<p>Since i'm using a ubuntu-like system i'll be using the ubuntu commands, feel free to check the github repo for other linux systems</p>
<pre class="notranslate"><code>$ sudo apt remove fprintd
$ sudo add-apt-repository ppa:uunicorn/open-fprintd
$ sudo apt-get update
$ sudo apt install open-fprintd fprintd-clients python3-validity
$ fprintd-enroll</code></pre>
<h1>Enroll new fingerprint</h1>
<p>Now if you don¬¥t have any error, you should be able to register your fingerprint using the command <code>fprintd-enroll</code> and press your finger to the fingerprint device multiple times until you get the message <code>Enroll result: enroll-completed</code></p>
<figure class="post__image"><code></code><img loading="lazy"  src="https://alrikrr.github.io/media/posts/32/fprintd-enroll.png" alt="Enroll-Print" width="526" height="279" sizes="(max-width: 48em) 100vw, 768px" srcset="https://alrikrr.github.io/media/posts/32/responsive/fprintd-enroll-xs.png 300w ,https://alrikrr.github.io/media/posts/32/responsive/fprintd-enroll-sm.png 480w ,https://alrikrr.github.io/media/posts/32/responsive/fprintd-enroll-md.png 768w"></figure>
<h2>Error list_devices failed:</h2>
<p>Now, if, like me, it doesn't work the first time, well, that's okay ‚Äì nobody's perfect</p>
<figure class="post__image"><img loading="lazy"  src="https://alrikrr.github.io/media/posts/32/error-enroll.png" alt="" width="313" height="53" sizes="(max-width: 48em) 100vw, 768px" srcset="https://alrikrr.github.io/media/posts/32/responsive/error-enroll-xs.png 300w ,https://alrikrr.github.io/media/posts/32/responsive/error-enroll-sm.png 480w ,https://alrikrr.github.io/media/posts/32/responsive/error-enroll-md.png 768w"></figure>
<p>If you check your python3-validity.service it should show you an error</p>
<figure class="post__image"><img loading="lazy"  src="https://alrikrr.github.io/media/posts/32/error-systemctl.png" alt="" width="1510" height="414" sizes="(max-width: 48em) 100vw, 768px" srcset="https://alrikrr.github.io/media/posts/32/responsive/error-systemctl-xs.png 300w ,https://alrikrr.github.io/media/posts/32/responsive/error-systemctl-sm.png 480w ,https://alrikrr.github.io/media/posts/32/responsive/error-systemctl-md.png 768w"></figure>
<p>You just need to do a factory reset of your fingerprint device using the command below</p>
<p><code></code></p>
<pre class="notranslate"><code>$ sudo systemctl stop python3-validity
$ sudo validity-sensors-firmware
$ sudo python3 /usr/share/python-validity/playground/factory-reset.py</code></pre>
<figure class="post__image"><img loading="lazy"  src="https://alrikrr.github.io/media/posts/32/factory-reset.png" alt="" width="1200" height="450" sizes="(max-width: 48em) 100vw, 768px" srcset="https://alrikrr.github.io/media/posts/32/responsive/factory-reset-xs.png 300w ,https://alrikrr.github.io/media/posts/32/responsive/factory-reset-sm.png 480w ,https://alrikrr.github.io/media/posts/32/responsive/factory-reset-md.png 768w"></figure>
<p>Now you should be able to start the python3-validy.service and enrolling your new fingerprint !</p>
<h1>PAM enable</h1>
<p>Before doing anything else, you want to enable the dinger-print device to unlock your session or using your finger to run a sudo command !</p>
<p>Do to so you'll need to update the PAM rules using¬†</p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto">
<pre class="notranslate"><code>$ sudo pam-auth-update
</code></pre>
<div class="zeroclipboard-container position-absolute right-0 top-0"><figure class="post__image"><img loading="lazy"  src="https://alrikrr.github.io/media/posts/32/pam-update.png" alt="" width="1883" height="526" sizes="(max-width: 48em) 100vw, 768px" srcset="https://alrikrr.github.io/media/posts/32/responsive/pam-update-xs.png 300w ,https://alrikrr.github.io/media/posts/32/responsive/pam-update-sm.png 480w ,https://alrikrr.github.io/media/posts/32/responsive/pam-update-md.png 768w"></figure></div>
</div>
<p>Here are the first lines of my <code>/etc/pam.d/common-auth</code> file</p>
<pre>auth ¬† ¬†[success=2 default=ignore] ¬† ¬†pam_fprintd.so max_tries=1 timeout=10 # debug<br>auth ¬† ¬†[success=1 default=ignore] ¬† ¬†pam_unix.so try_first_pass nullok_secure</pre>
<p>Now your sensor should be working. Perhaps a reboot wouldn't hurt to ensure everything is functioning correctly!</p>
<p>¬†</p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>My PNPT FeedBack</title>
        <author>
            <name>AlrikRr</name>
        </author>
        <link href="https://alrikrr.github.io/my-pnpt-feedback/"/>
        <id>https://alrikrr.github.io/my-pnpt-feedback/</id>
        <media:content url="https://alrikrr.github.io/media/posts/2/my-cert.jpg" medium="image" />
            <category term="Updates"/>

        <updated>2023-08-15T19:11:58-04:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://alrikrr.github.io/media/posts/2/my-cert.jpg" alt="My PNPT Feedback" />
                    Hi! Today I‚Äôm going to share with you my feedback on the PNPT certification that I passed at the beginning&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <p><img src="https://alrikrr.github.io/media/posts/2/my-cert.jpg" class="type:primaryImage" alt="My PNPT Feedback" /></p>
                <p>Hi! Today I‚Äôm going to share with you my feedback on the PNPT certification that I passed at the beginning of August 2023 by reviewing the before and during the exam!</p>
<hr>
<div class="post__toc">
<h3>Table of Contents</h3>
<ul>
<li><a href="#my-knowledge">My Knowledge</a></li>
<li><a href="#mcetoc_1h7tmfdnggn">PNPT &amp; Package Course</a></li>
<li><a href="#mcetoc_1h7tmfdnggo">Exam Period - 5 Days</a>
<ul>
<li><a href="#mcetoc_1h7tmfdnggp">Exam Skills</a></li>
<li><a href="#mcetoc_1h7tmfdnggq">Exam Package</a></li>
<li><a href="#mcetoc_1h7tmfdnggr">My Exam</a></li>
</ul>
</li>
<li><a href="#mcetoc_1h7tmfdnggs">Report Period - 2 days</a></li>
<li><a href="#mcetoc_1h7tmfdnggt">Final Presentation</a></li>
</ul>
</div>
<h1 id="my-knowledge">My Background</h1>
<p>Before we dive deeper, let me clarify my experience since I see few people talking about their skills before starting the examination. I have 4 years of experience in the field of computer security, with 2 actual years spent as a Pentester. I frequently practice at home, as well as during missions conducting intrusion tests on both internal and external client environments. Moreover, report writing is no longer a mysterious art for me. So, I‚Äôm embarking on this certification with a significant advantage compared to someone new to this field. üõ°Ô∏è</p>
<figure class="post__image post__image--center"><img loading="lazy"  src="https://alrikrr.github.io/media/posts/2/pnpt-2.jpeg" alt="" width="468" height="297" sizes="(max-width: 48em) 100vw, 768px" srcset="https://alrikrr.github.io/media/posts/2/responsive/pnpt-2-xs.jpeg 300w ,https://alrikrr.github.io/media/posts/2/responsive/pnpt-2-sm.jpeg 480w ,https://alrikrr.github.io/media/posts/2/responsive/pnpt-2-md.jpeg 768w"></figure>
<h1 id="mcetoc_1h7tmfdnggn">PNPT &amp; Package Course</h1>
<p>Before purchasing the PNPT courses and voucher, it‚Äôs essential to note that the two exam vouchers do not have an expiration date. The courses are available on the Academic TCM-Security platform, and you‚Äôll be provided with five courses, along with their completion percentages, to give you an idea of what I‚Äôve gone through so far:</p>
<ul>
<li>Practical Ethical Hacking - The Complete Course¬†<strong>94%</strong></li>
<li>Windows Privilege Escalation for Beginners¬†<strong>75%</strong></li>
<li>Linux Privilege Escalation for Beginners¬†<strong>0%</strong></li>
<li>Open-Source Intelligence (OSINT) Fundamentals¬†<strong>0%</strong></li>
<li>External Pentest Playbook¬†<strong>0%</strong></li>
</ul>
<p>Additionally, you‚Äôll have access to VODs of Twitch live sessions:</p>
<ul>
<li>PNPT Live Training VOD¬†<strong>0%</strong></li>
</ul>
<p class="msg msg--warning">Please note that just because I haven‚Äôt finished all the courses doesn‚Äôt mean you should follow suit. As I mentioned earlier, I‚Äôm starting with an advantage.</p>
<h1 id="mcetoc_1h7tmfdnggo">Exam Period - 5 Days</h1>
<p>It‚Äôs go-time! You‚Äôve set up your Kali Linux virtual machine, and the countdown has begun!</p>
<p>You‚Äôve got 5 days to conquer this examination, which means compromising both the external and internal scope, ‚Äúsecuring‚Äù that Domain Admin access to the Domain Controller! All‚Äôs fair in this quest, but just remember, you‚Äôll be following a step-by-step process, just like on a genuine pentesting engagement with a client. So, no DDOS or other disruptions ‚Äì they could spell the end of your exam period!</p>
<h2 id="mcetoc_1h7tmfdnggp">Exam Skills</h2>
<p>If I can offer you a few tips on the areas to review and master before taking the exam, here they are:</p>
<ul>
<li>OSINT (Open-Source Intelligence)</li>
<li>Web Application Pentesting</li>
<li>Pivoting and Proxychains</li>
<li>Active Directory Pentesting</li>
<li>Enumeration, Enumeration, ENUMERATION!</li>
</ul>
<h2 id="mcetoc_1h7tmfdnggq">Exam Package</h2>
<p>Regarding your Exam Package, you‚Äôll receive a PDF document containing your scope and instructions from your client. You can also make use of the password wordlists kindly provided by TCM (it‚Äôll make your life easier!).</p>
<p>Lastly, you‚Äôll receive your VPN access for the lab and the option to revert or stop the lab whenever you want. This won‚Äôt affect the lab‚Äôs configuration or the exam duration.</p>
<h2 id="mcetoc_1h7tmfdnggr">My Exam</h2>
<p>As for me, I faced a few challenges during the enumeration phase. I won‚Äôt say more to avoid spoiling anything! The attacks weren‚Äôt overly difficult; they‚Äôre entirely manageable even for beginners if you follow the courses provided by TCM.</p>
<p>Still, it‚Äôs a lab exam that somewhat mirrors reality, even though everything is designed to give you hints about where to look and what to do without causing too many issues.</p>
<figure class="post__image post__image--center"><img loading="lazy"  src="https://alrikrr.github.io/media/posts/2/meme-0.jpg" alt="Private PNPT joke" width="369" height="298" sizes="(max-width: 48em) 100vw, 768px" srcset="https://alrikrr.github.io/media/posts/2/responsive/meme-0-xs.jpg 300w ,https://alrikrr.github.io/media/posts/2/responsive/meme-0-sm.jpg 480w ,https://alrikrr.github.io/media/posts/2/responsive/meme-0-md.jpg 768w"></figure>
<h1 id="mcetoc_1h7tmfdnggs">Report Period - 2 days</h1>
<p>When it comes to the report writing phase, it‚Äôs also nothing overly complicated. I can only advise you to capture screenshots BEFORE your exam period ends!</p>
<p>As for what I did, I took notes on the vulnerabilities I discovered and how to exploit them. It‚Äôs important to provide Proof of Concepts (PoCs) but also suggestions for fixing them. Remember, this report is intended for a client, so write it accordingly. Include both the technical and executive aspects.</p>
<p>My report ended up being a total of 60 pages. I can list the main headings for you to give you an idea of the content, in case it helps inspire you!</p>
<ul>
<li>Objective &amp; Context</li>
<li>Scope</li>
<li>Server Discovery</li>
<li>Testing Methodology</li>
<li>Score &amp; Severity</li>
<li>Executive Summary</li>
<li>Vulnerability Summary</li>
<li>Remediation Summary</li>
<li>Attack Paths</li>
<li>Technical Details (Vulnerability Details and PoCs)</li>
</ul>
<figure class="post__image post__image--center"><img loading="lazy"  src="https://alrikrr.github.io/media/posts/2/meme-1.jpeg" alt="" width="517" height="499" sizes="(max-width: 48em) 100vw, 768px" srcset="https://alrikrr.github.io/media/posts/2/responsive/meme-1-xs.jpeg 300w ,https://alrikrr.github.io/media/posts/2/responsive/meme-1-sm.jpeg 480w ,https://alrikrr.github.io/media/posts/2/responsive/meme-1-md.jpeg 768w"></figure>
<h1 id="mcetoc_1h7tmfdnggt">Final Presentation</h1>
<p>Aside from the technical hiccups at the beginning of the presentation (well, you can‚Äôt really hide the chaos, can you‚Ä¶), it was quite swift ‚Äì no more than 15 minutes ‚Äì with a few questions from the examiner. On my end, I jumped right into presenting the English PDF report (with my French Baguette accent).</p>
<p>The atmosphere was friendly, with no pressure as long as you‚Äôre confident in your subject! The advantage is that the examiner will give you the final verdict right away, letting you know if you‚Äôve earned your certification or not.</p>
<figure class="post__image post__image--center"><img loading="lazy"  src="https://alrikrr.github.io/media/posts/2/pnpt-3.gif" alt="" width="360" height="225"></figure>
<figure class="post__image post__image--center"><img loading="lazy"  src="https://alrikrr.github.io/media/posts/2/pnpt-4.gif" alt="" width="360" height="202"></figure>
<div id="post-content" class="post-content">
<p>It‚Äôs still a great experience with TCM-Security. If you have any questions, I can answer them without revealing the exam‚Äôs content. As for me, I‚Äôm leaning towards the next certification in Malware Analysis, PJMR!</p>
</div>
<div class="row pl-3 pr-3">¬†</div>
            ]]>
        </content>
    </entry>
    <entry>
        <title>#9 Nsec21 - Tom&#x27;s Hut part2</title>
        <author>
            <name>AlrikRr</name>
        </author>
        <link href="https://alrikrr.github.io/9-nsec21-toms-hut-part2/"/>
        <id>https://alrikrr.github.io/9-nsec21-toms-hut-part2/</id>
        <media:content url="https://alrikrr.github.io/media/posts/25/nsec-Badge.jpg" medium="image" />
            <category term="Write Up"/>
            <category term="BadgeLife"/>

        <updated>2023-08-15T21:53:28-04:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://alrikrr.github.io/media/posts/25/nsec-Badge.jpg" alt="" />
                    If you want to fully understand this post I can only recommand you to read the previous one (Flag 8&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <p><img src="https://alrikrr.github.io/media/posts/25/nsec-Badge.jpg" class="type:primaryImage" alt="" /></p>
                <p>If you want to fully understand this post I can only recommand you to read the previous one (Flag 8 part1)</p>
<h1 id="re102-reverse">RE102 Reverse</h1>
<p>Like the previous one, the architecture is Xtensa, but this time I already have the right module for Ghidra !</p>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/write-up/nsec-2021/9-flag/xtensa_elf.png" alt="Xtensa Binary" data-is-external-image="true"></p>
<p>Using Ghidra I‚Äôm doing the import and the analysis of the binary.</p>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/write-up/nsec-2021/9-flag/ghidra_import.png" alt="Ghidra" data-is-external-image="true"></p>
<h1 id="app-main">App Main</h1>
<p>The¬†<code>app_main</code>¬†function is very similar to¬†<code>RE101</code>, so this time let‚Äôs jump on the¬†<code>verify</code>¬†function !</p>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/write-up/nsec-2021/9-flag/app_main.png" alt="App Main" data-is-external-image="true"></p>
<h2 id="verify">Verify</h2>
<p>This time its different, as we can see the user input is stored inside¬†<code>user_code</code>¬†and the check is done using¬†<code>a8</code>¬†registry.<br>In the first example, the first element of the input is checked with¬†<code>0x66</code>¬†which is a¬†<code>f</code>.</p>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/write-up/nsec-2021/9-flag/verify_stuff.png" alt="Verify Function" data-is-external-image="true"></p>
<p>We just need to jump into each function and check which element is checked and with which character.</p>
<h1 id="flag">Flag</h1>
<p>The final FLAG is<code>f219e6cdb1fa4a48b160d00d61118f93</code></p>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/write-up/nsec-2021/9-flag/flag.png" alt="Flag" data-is-external-image="true"></p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>#8 Nsec21 - Tom&#x27;s Hut part1</title>
        <author>
            <name>AlrikRr</name>
        </author>
        <link href="https://alrikrr.github.io/8-nsec21-toms-hut-part1/"/>
        <id>https://alrikrr.github.io/8-nsec21-toms-hut-part1/</id>
        <media:content url="https://alrikrr.github.io/media/posts/24/nsec-Badge.jpg" medium="image" />
            <category term="Write Up"/>
            <category term="BadgeLife"/>

        <updated>2023-08-15T21:52:35-04:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://alrikrr.github.io/media/posts/24/nsec-Badge.jpg" alt="" />
                    The next 2 Flags are binary reverse, I was very very rusty on this one ‚Ä¶ So, this challenge is&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <p><img src="https://alrikrr.github.io/media/posts/24/nsec-Badge.jpg" class="type:primaryImage" alt="" /></p>
                <p>The next 2 Flags are binary reverse, I was very very rusty on this one ‚Ä¶</p>
<h1 id="wi-fi-join">Wi-Fi Join</h1>
<p>So, this challenge is accessible from Tom‚Äôs Hut after you have joined a Wi-Fi network !</p>
<p>To join a Wi-Fi network, you need to access the serial port using¬†<code>screen</code>¬†(check Chall 7 !) and use the following command:</p>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/write-up/nsec-2021/8-flag/wifi-connect.png" alt="WF-Connect" data-is-external-image="true"></p>
<p>You should receive an IP, you can now go to Tom‚Äôs Hut and see the following message !</p>
<figure class="post__image"><img loading="lazy"  src="https://alrikrr.github.io/media/posts/24/Screenshot-from-2023-04-20-16-30-56.png" alt="" width="941" height="837" sizes="(max-width: 48em) 100vw, 768px" srcset="https://alrikrr.github.io/media/posts/24/responsive/Screenshot-from-2023-04-20-16-30-56-xs.png 300w ,https://alrikrr.github.io/media/posts/24/responsive/Screenshot-from-2023-04-20-16-30-56-sm.png 480w ,https://alrikrr.github.io/media/posts/24/responsive/Screenshot-from-2023-04-20-16-30-56-md.png 768w"></figure>
<p>Download both of the binaries, RE101 and RE102.</p>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/write-up/nsec-2021/8-flag/download-re.png" alt="Download Binaries" data-is-external-image="true"></p>
<h1 id="re101---reverse">RE101 - Reverse</h1>
<p>The first binary named¬†<code>re101.elf</code>¬†is a binary using Xtensa architecture.</p>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/write-up/nsec-2021/8-flag/re101-elf.png" alt="re101" data-is-external-image="true"></p>
<h2 id="xtensa-processor">Xtensa Processor</h2>
<p>I can¬¥t execute it on my machine so I‚Äôll use Ghidra to dissas and take a look inside.</p>
<p>Unfortunately Ghidra can‚Äôt understand Xtensa binaries by default, so I need to add an extra Processor, here is the github link</p>
<ul>
<li><a href="https://github.com/yath/ghidra-xtensa">Xtensa Arch - Github</a></li>
</ul>
<p>The install is explained inside the README.md but becarefull to gve your user the full ownership of the xtensa folder.</p>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/write-up/nsec-2021/8-flag/ghidra-xtensa.png" alt="xtensa ghidra" data-is-external-image="true"></p>
<p>Now the binary is recognized, we can analyse it and reverse it !</p>
<h2 id="main-function">Main function</h2>
<p>The main function is easly located in the ghidra function folder.</p>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/write-up/nsec-2021/8-flag/main_func.png" alt="Main Function" data-is-external-image="true"></p>
<p>As we can see, this function accept a user input and then check this input with¬†<code>verify</code>¬†function. Depending of the user input, the¬†<code>verify</code>function will display the flag or not.</p>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/write-up/nsec-2021/8-flag/main_fun_full.png" alt="Main Function Full" data-is-external-image="true"></p>
<h2 id="verify-">Verify !</h2>
<p>The main function won¬¥t give us more information so let‚Äôs dig into¬†<code>verify</code>function !</p>
<p>This one is a bit tricky but after half an hour, I sort of understand how it works.</p>
<p>So, the user input in¬†<code>a1</code>¬†is checked characters by charaters but not in the right order.<br>The characters that are compared are stored inside¬†<code>a3</code>,¬†<code>a8</code>¬†etc. and the value of these registers are changing during the execution of the binary.</p>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/write-up/nsec-2021/8-flag/verify_code.png" alt="Verify Code" data-is-external-image="true"></p>
<p>I was a bit lazy on this one and used a notepad to check characters by characters the user input and then found the FLAG.</p>
<p>Here is the correct order for each check.</p>
<p>So you have the value¬†<code>a</code>¬†something with the affected value using¬†<code>movi</code>. Then the¬†<code>Stack</code>¬†whith the position of the letter checked inside the user input and it‚Äôs value.</p>
<div class="highlight">
<pre tabindex="0"><code class="language-text" data-lang="text">        400e4248 36 41 01        entry      a1 = 'u'
        400e424b c2 a0 63        movi       a12 = 'c'
        400e424e c2 61 15        s32i       a12,a1,0x54=&gt;Stack[0x54] ---&gt; 22 = c
        400e4251 82 a0 62        movi       a8 = 'b' 
        400e4254 82 61 10        s32i       a8,a1,0x40=&gt;Stack[0x40]  ---&gt; 17 = b
        400e4257 3c 4e           movi.n     a14 = '4'
        400e4259 e9 a1           s32i.n     a14,a1,0x28=&gt;Stack[0x28]  ---&gt; 11 = 4
        400e425b 3c 3b           movi.n     a11 = '3'
        400e425d b2 61 12        s32i       a11,a1,0x48=&gt;Stack[0x48] ---&gt; 19 = 3
        400e4260 3c 83           movi.n     a3 = '8'
        400e4262 32 61 18        s32i       a3,a1,0x60=&gt;Stack[0x60]  ---&gt; 25 = 8
        400e4265 82 61 19        s32i       a8,a1,0x64=&gt;Stack[0x64]  ---&gt; 26 = b 
        400e4268 3c 2a           movi.n     a10 = '2'
        400e426a a9 51           s32i.n     a10,a1,0x14=&gt;Stack[0x14] ---&gt; 6 = 2
        400e426c 3c 18           movi.n     a8 = '1'
        400e426e 89 01           s32i.n     a8,a1=&gt;Stack[0x0],0x0     ----&gt; 1  = 1
        400e4270 a2 61 17        s32i       a10,a1,0x5c=&gt;Stack[0x5c]  ---&gt; 24 = 2 
        400e4273 82 61 16        s32i       a8,a1,0x58=&gt;Stack[0x58] ---&gt; 23 = 1
        400e4276 3c 7f           movi.n     a15 = '7'
        400e4278 f2 61 1d        s32i       a15,a1,0x74=&gt;Stack[0x74]  ---&gt; 30 = 7 
        400e427b 3c 9d           movi.n     a13 = '9'
        400e427d d9 31           s32i.n     a13,a1,0xc=&gt;Stack[0xc]    ----&gt; 4 = 9 
        400e427f 82 61 13        s32i       a8,a1,0x4c=&gt;Stack[0x4c]  ----&gt; 20 = 1 
        400e4282 92 a0 61        movi       a9 = 'a'
        400e4285 99 21           s32i.n     a9,a1,0x8=&gt;Stack[0x8]   ------&gt; 3 = a
        400e4287 92 a0 65        movi       a9 = 'e'
        400e428a 99 f1           s32i.n     a9,a1,0x3c=&gt;Stack[0x3c]  ---&gt; 16 = e 
        400e428c 82 61 11        s32i       a8,a1,0x44=&gt;Stack[0x44]  ---&gt; 18 = 1 
        400e428f 89 11           s32i.n     a8,a1,0x4=&gt;Stack[0x4]    -----&gt; 2 = 1
        400e4291 89 61           s32i.n     a8,a1,0x18=&gt;Stack[0x18]  ---&gt; 7 = 1 
        400e4293 3c 09           movi.n     a9 = '0'
        400e4295 92 61 1f        s32i       a9,a1,0x7c=&gt;Stack[0x7c] ---&gt; 32 = 0
        400e4298 3c 69           movi.n     a9 = '6'
        400e429a 99 e1           s32i.n     a9,a1,0x38=&gt;Stack[0x38]  ---&gt; 15 = 6 
        400e429c a9 41           s32i.n     a10,a1,0x10=&gt;Stack[0x10] ---&gt; 5 = 2 
        400e429e 39 71           s32i.n     a3,a1,0x1c=&gt;Stack[0x1c]  ---&gt; 8 = 8
        400e42a0 92 61 1b        s32i       a9,a1,0x6c=&gt;Stack[0x6c]  ---&gt; 28 = 6
        400e42a3 f2 61 14        s32i       a15,a1,0x50=&gt;Stack[0x50] ---&gt; 21 = 7
        400e42a6 99 81           s32i.n     a9,a1,0x20=&gt;Stack[0x20]  ---&gt; 9 = 6
        400e42a8 e9 c1           s32i.n     a14,a1,0x30=&gt;Stack[0x30] ---&gt; 13 = 4
        400e42aa 82 61 1c        s32i       a8,a1,0x70=&gt;Stack[0x70]  ---&gt; 29 = 1
        400e42ad d9 d1           s32i.n     a13,a1,0x34=&gt;Stack[0x34]  ---&gt; 14 = 9
        400e42af a2 61 1e        s32i       a10,a1,0x78=&gt;Stack[0x78] ---&gt; 31 = 2
        400e42b2 99 b1           s32i.n     a9,a1,0x2c=&gt;Stack[0x2c]  ---&gt; 12 = 6
        400e42b4 c9 91           s32i.n     a12,a1,0x24=&gt;Stack[0x24] ---&gt; 10  = c
        400e42b6 b2 61 1a        s32i       a11,a1,0x68=&gt;Stack[0x68] ---&gt; 27 = 3
        400e42b9 0c 08           movi.n     a8 = '0'
</code></pre>
</div>
<h1 id="flag">Flag</h1>
<p>So, at the end, with all the position in the right order, here is the flag</p>
<ul>
<li>Flag =¬†<code>11a922186c46496eb1317c128b361720</code></li>
</ul>
<p>We can validate the challenge using the CLI on the badge</p>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/write-up/nsec-2021/8-flag/validate.png" alt="Validation" data-is-external-image="true"></p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>#7 Nsec21 - Reboot</title>
        <author>
            <name>AlrikRr</name>
        </author>
        <link href="https://alrikrr.github.io/7-nsec21-reboot/"/>
        <id>https://alrikrr.github.io/7-nsec21-reboot/</id>
        <media:content url="https://alrikrr.github.io/media/posts/23/nsec-Badge.jpg" medium="image" />
            <category term="Write Up"/>
            <category term="BadgeLife"/>

        <updated>2023-08-15T21:49:17-04:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://alrikrr.github.io/media/posts/23/nsec-Badge.jpg" alt="" />
                    I was also lucky on this one. After connecting to the device using the serial port with the screen command:&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <p><img src="https://alrikrr.github.io/media/posts/23/nsec-Badge.jpg" class="type:primaryImage" alt="" /></p>
                <p>I was also lucky on this one.</p>
<h1 id="tty-cli">tty CLI</h1>
<p>After connecting to the device using the serial port with the screen command:</p>
<div class="highlight">
<pre tabindex="0"><code class="language-bash hljs" data-lang="bash">sudo screen /dev/ttyUSB0 115200
</code></pre>
</div>
<p>If you can¬¥t see your ttyUSB, try using¬†<code>dmesg</code>¬†after connecting the badge on your computer.</p>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/write-up/nsec-2021/7-flag/dmesg.png" alt="dmesg debug" data-is-external-image="true"></p>
<p>And also check your¬†<code>/dev/</code>¬†folder</p>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/write-up/nsec-2021/7-flag/ttyUSB0.png" alt="ttyUSB in dev" data-is-external-image="true"></p>
<h1 id="reboot-">Reboot !</h1>
<p>As you can see, behind the badge, there is a reboot button, and I keep pressing it by mistake!</p>
<p>However, after looking at the terminal, I saw the full message and a small help menu before the shell!</p>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/write-up/nsec-2021/7-flag/tab-reboot.png" alt="Reboot menu" data-is-external-image="true"></p>
<p>As you can see, I can use TAB to autocomplete commands. Maybe I need to found a hidden command which is not displayed with¬†<code>help</code>¬†command ?</p>
<p>After pressing a few keys, I was able to discover the secret command¬†<code>the_sword_of_azeroth!</code></p>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/write-up/nsec-2021/7-flag/letter-t.png" alt="Sword" data-is-external-image="true"></p>
<h1 id="flag">Flag</h1>
<p>Here is the 7th Flag :¬†<code>FLAG-Cl1F0rFun&amp;Pr0f1t</code></p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>#5 Nsec21 - Punk Down</title>
        <author>
            <name>AlrikRr</name>
        </author>
        <link href="https://alrikrr.github.io/5-nsec21-punk-down/"/>
        <id>https://alrikrr.github.io/5-nsec21-punk-down/</id>
        <media:content url="https://alrikrr.github.io/media/posts/22/nsec-Badge.jpg" medium="image" />
            <category term="Write Up"/>
            <category term="BadgeLife"/>

        <updated>2023-08-15T21:48:30-04:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://alrikrr.github.io/media/posts/22/nsec-Badge.jpg" alt="" />
                    Okay for this one I don‚Äôt have the reference but I managed to found it by accident ! It‚Äôs actually&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <p><img src="https://alrikrr.github.io/media/posts/22/nsec-Badge.jpg" class="type:primaryImage" alt="" /></p>
                <p>Okay for this one I don‚Äôt have the reference but I managed to found it by accident ! It‚Äôs actually the second one I found during my journey.</p>
<h1 id="punk-guy">Punk Guy</h1>
<p>I was playing around the place and speak to this Punk Guy right here<br><img loading="lazy" src="https://alrikrr.github.io/posts/write-up/nsec-2021/5-flag/flag5.png" alt="Punk Guy" data-is-external-image="true"></p>
<p>During the conversation, I found the flag by accident by pressing the Down Button¬†<img loading="lazy" src="https://alrikrr.github.io/posts/write-up/nsec-2021/5-flag/punk1.png" alt="Punk Guy" data-is-external-image="true"></p>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/write-up/nsec-2021/5-flag/punk2.png" alt="Flag 5 " data-is-external-image="true"></p>
<h1 id="flag-5">Flag 5</h1>
<p>The flag is¬†<code>FLAG-KLJV490uhkEJF28</code></p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>#1 Nsec21 - Welcome</title>
        <author>
            <name>AlrikRr</name>
        </author>
        <link href="https://alrikrr.github.io/1-nsec21-welcome/"/>
        <id>https://alrikrr.github.io/1-nsec21-welcome/</id>
        <media:content url="https://alrikrr.github.io/media/posts/21/nsec-Badge.jpg" medium="image" />
            <category term="Write Up"/>
            <category term="BadgeLife"/>

        <updated>2023-08-15T21:47:43-04:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://alrikrr.github.io/media/posts/21/nsec-Badge.jpg" alt="" />
                    Hello everyone ! It‚Äôs been a while since my last post but I‚Äôm still alive no worries üòÅ Today I‚Äôm&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <p><img src="https://alrikrr.github.io/media/posts/21/nsec-Badge.jpg" class="type:primaryImage" alt="" /></p>
                <p>Hello everyone ! It‚Äôs been a while since my last post but I‚Äôm still alive no worries üòÅ</p>
<p>Today I‚Äôm gonna post some write-up for the NorthSec 2021 Badge CTF ! I purchase the badge last year and din‚Äôt have time to play with it so here I am !<br>It‚Äôs actually my first CTF Badge and I hope im going to fine all the flags !</p>
<h1 id="device">Device</h1>
<p>Here is a full spec of the nsec badge :¬†<a href="https://github.com/nsec/nsec-badge">available here</a></p>
<p>Here is the Badge in the front<br><img loading="lazy" src="https://alrikrr.github.io/posts/write-up/nsec-2021/1-flag/badge-1.png" alt="Badge Face" data-is-external-image="true"></p>
<p>and here is the back of the badge<br><img loading="lazy" src="https://alrikrr.github.io/posts/write-up/nsec-2021/1-flag/badge-2.png" alt="Badge Back" data-is-external-image="true"></p>
<p>This one is very cool, good job for Nsec Team !</p>
<h1 id="welcome-flag">Welcome Flag</h1>
<p>Well at least I found 1 flag so far which is the Welcome Flag ! This one is available on top of the entrance inside this chest.</p>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/write-up/nsec-2021/1-flag/flag-1.png" alt="flag 1" data-is-external-image="true"></p>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/write-up/nsec-2021/1-flag/welcome-flag.png" alt="Welcome Flage" data-is-external-image="true"></p>
<h1 id="flag">Flag</h1>
<p>Flag 1 :¬†<code>FLAG-W3lc0m2NSECxx</code></p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>My CRTS Feedback</title>
        <author>
            <name>AlrikRr</name>
        </author>
        <link href="https://alrikrr.github.io/my-crts-feedback/"/>
        <id>https://alrikrr.github.io/my-crts-feedback/</id>
        <media:content url="https://alrikrr.github.io/media/posts/4/my-crts.jpg" medium="image" />
            <category term="Updates"/>

        <updated>2023-08-15T19:10:06-04:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://alrikrr.github.io/media/posts/4/my-crts.jpg" alt="My CRTS Feedback" />
                    Hello everyone, Happy New Year ! This is actually my first post of 2023 and nothing better than to tell&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <p><img src="https://alrikrr.github.io/media/posts/4/my-crts.jpg" class="type:primaryImage" alt="My CRTS Feedback" /></p>
                <div>Hello everyone, Happy New Year !</div>
<div>This is actually my first post of 2023 and nothing better than to tell you about a certification I just completed.¬†</div>
<h1>What's CRTS ?</h1>
<div>
<div>CRTS or Certified Red Team Specialist from<a href="https://www.cyberwarfare.live/" target="_blank" rel="noopener noreferrer"> Cyber Warfare</a> is a Technical Certification designed to improve your Red Team skills in many Offensive Fields. Your goal is to compromise an entire lab including 4 different networks !</div>
<br>
<div>You must use one of three attack paths to do this. Here is a picture of the internal lab.</div>
<div><figure class="post__image post__image--center"><img loading="lazy"  src="https://alrikrr.github.io/media/posts/4/crts-lab.png" alt="" width="2560" height="1440" sizes="(max-width: 48em) 100vw, 768px" srcset="https://alrikrr.github.io/media/posts/4/responsive/crts-lab-xs.png 300w ,https://alrikrr.github.io/media/posts/4/responsive/crts-lab-sm.png 480w ,https://alrikrr.github.io/media/posts/4/responsive/crts-lab-md.png 768w"></figure></div>
<a href="https://www.cyberwarfare.live/courses/certified-red-team-specialist" target="_blank" rel="noopener noreferrer">Certification Link</a></div>
<div>¬†</div>
<div>
<div>The bunbdle I took (30 days access) comes with VPN access of the internal lab, three PDF write-up for each attack path, digital badge and certification. 30 days is the minimum time, you can extend your lab time if you want.</div>
<h1>My Experience</h1>
<p>Well, this certification turned out to be quite a surprise for me. Initially, I wasn't expecting much beyond a simple lab, and then it transformed into an incredibly engaging experience. The internal lab setup was so well-done that I found it truly enjoyable!<br><br>You have the freedom to choose any attack path you prefer. I went with the first one, which involves a Web attack. Once you compromise the web server, you're required to pivot into another internal Active Directory network. Once you compromise the domain, you're faced with yet another pivot to an internal Active Directory network linked through a Trust Forest design. Let me tell you, after completing this lab, I became a pro at pivoting and post-exploitation on Active Directory!<br><br>The cherry on top is gaining access to a complete SCADA network ‚Äì personally, that was the most satisfying reward for me!<br><br>And don't forget about the attack on Kubernetes and Docker containers; it's a fascinating aspect since you don't often get to play around with them in real pentesting engagements!</p>
<h1>Worth It ?</h1>
<div>I would recommend starting with a solid methodology and having a prior taste of penetration testing and Red Team skills. Relying solely on the WriteUps provided by Cyberwarfare won't cut it, as it's not always 100% detailed and might not explain every command required to reach the final objective. Consider the WriteUps as an emergency toolkit for when you're stuck!<br><br>In my case, I followed my instincts for the initial attack path. When I hit roadblocks, I turned to the writeup, especially for machines that I wasn't particularly comfortable with, like the Kubernetes (K8S) and the intensive pivoting parts.</div>
<p>¬†</p>
</div>
            ]]>
        </content>
    </entry>
    <entry>
        <title>TP-Link AC750 Wifi Router</title>
        <author>
            <name>AlrikRr</name>
        </author>
        <link href="https://alrikrr.github.io/tp-link-ac750-wifi-router/"/>
        <id>https://alrikrr.github.io/tp-link-ac750-wifi-router/</id>
        <media:content url="https://alrikrr.github.io/media/posts/11/iot.jpg" medium="image" />
            <category term="IoT Hacking"/>

        <updated>2023-08-15T20:43:21-04:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://alrikrr.github.io/media/posts/11/iot.jpg" alt="" />
                    Improper handling of electronic components can lead to component destruction Here is my LinkedIn post related to this article :¬†LinkedIn-Post&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <p><img src="https://alrikrr.github.io/media/posts/11/iot.jpg" class="type:primaryImage" alt="" /></p>
                <p class="alert alert-danger msg msg--warning"><strong>Improper handling of electronic components can lead to component destruction</strong></p>
<p class="alert alert-info msg msg--warning"><strong>Here is my LinkedIn post related to this article :¬†<a href="https://www.linkedin.com/feed/update/urn:li:activity:6978797904089989120/">LinkedIn-Post</a></strong></p>
<hr>
<h1 id="what-you-need">What you need</h1>
<p>Here are all the tools you need to perform this kind of IoT Assessment on a device. For my part I didn‚Äôt have my soldering kit so I did it without but it was not very stable.</p>
<ul>
<li>Basic knowledge on UART ad IOT Hacking</li>
<li>UART Bridge (Simple USB or Flipper Zero)</li>
<li>Multimeter</li>
<li>Cables</li>
<li>Solder Iron (Optionnal)</li>
<li>UART Device like Wifi Router</li>
</ul>
<h2 id="uart-">UART ?</h2>
<p>If you are not familiar with UART ports, I would recommend you to check my article on Flipper-Zero Section¬†<strong><a href="https://alrikrr.github.io/flipperzero-uart-bridge-rpi4-to-flipper/" target="_blank" rel="noopener noreferrer">UART USB Bridge</a></strong></p>
<p>If this is not enough, check out this video of FlashBack-Team¬†<a href="https://youtu.be/01mw0oTHwxg">Hacker‚Äôs Guide to UART Root Shells</a></p>
<h1 id="tp-link-ac750">TP-Link AC750</h1>
<h2 id="informations">Informations</h2>
<p>The device I used was a¬†<a href="https://www.tp-link.com/ca/home-networking/wifi-router/archer-c20/">TP-Link Wifi Router AC750</a></p>
<ul>
<li>Supports 802.11ac standard - the next generation of Wi-Fi</li>
<li>Simultaneous 2.4GHz 300Mbps and 5GHz 433Mbps connections for 733Mbps of total available bandwidth</li>
<li>3 external antennas provide stable omnidirectional signal and superior wireless coverage</li>
</ul>
<p>While doing OSINT on the device, you can easly found internal and externl picture of it.</p>
<ul>
<li><a href="https://fccid.io/TE7C20">https://fccid.io/TE7C20</a></li>
<li><a href="https://fccid.io/TE7C20/Internal-Photos/Internal-Photos-2582175">Internal Pictures</a></li>
</ul>
<p>Each WIFI device has a FCC ID which is very usefull to search specs and internal pictures.</p>
<h2 id="uart-port">UART port</h2>
<p>I was lucky on this one since the UART ports are labeled, so no need to test them with multimeter</p>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/reverse-engineering/iot-hacking/tplink-ac750/uart-port.png" alt="Uart port" data-is-external-image="true"></p>
<h2 id="components">Components</h2>
<ul>
<li>Wifi Chip - MT7628an
<ul>
<li><a href="http://vonger.cn/upload/MT7628_Full.pdf">Datasheet</a></li>
</ul>
</li>
<li>DDR SDRAM - M14D5121632A
<ul>
<li><a href="https://www.endrich.com/fm/2/M14D5121632A-2.5BG2K.pdf">Datasheet</a></li>
</ul>
</li>
<li>Wifi Chip - MT7610EN
<ul>
<li><a href="https://datasheetspdf.com/pdf/851068/Ralink/MT7610EN/1">Datasheet</a></li>
</ul>
</li>
<li>Flash - 25Q64CSIG (Back of the PCB)
<ul>
<li><a href="https://www.alldatasheet.com/view_datasheet.jsp?Searchword=25Q64CSIG&amp;sField=1">Datasheet</a></li>
</ul>
</li>
</ul>
<h2>UART Bridge USB</h2>
<p>Here is what my setup looks like. Like you can see I didn‚Äôt use any soldering Iron because I didn‚Äôt have one during this time.</p>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/reverse-engineering/iot-hacking/tplink-ac750/uart-bridge.png" alt="UART Bridge" data-is-external-image="true"></p>
<p>The UART bridge is very simple, here is a small schemas :</p>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/reverse-engineering/iot-hacking/tplink-ac750/plan.png" alt="Plan" data-is-external-image="true"></p>
<p>I‚Äôll recommand you to check my post about this part : <a href="https://alrikrr.github.io/flipperzero-uart-bridge-rpi4-to-flipper/" target="_blank" rel="noopener noreferrer">UART USB Bridge</a></p>
<p>Using¬†<code>minicom</code>¬†we can get a shell once the device is powered on !</p>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/reverse-engineering/iot-hacking/tplink-ac750/2_filesystem.png" alt="FileSystem" data-is-external-image="true"></p>
<h1 id="shell-and-enumeration">Shell and Enumeration</h1>
<p>Let‚Äôs start the enumeration part on the device.<br>Just for the context I didn‚Äôt have any password for this Wifi router, SSID passwords and Admin Web password.</p>
<p>The system is on read only so we can‚Äôt edit anything unfortunatly.</p>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/reverse-engineering/iot-hacking/tplink-ac750/9_readonly_fs.png" alt="Read Only FS" data-is-external-image="true"></p>
<h2 id="etcpasswd">/etc/passwd</h2>
<p>The first goodies we can get is the users and the passwords of the system.</p>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/reverse-engineering/iot-hacking/tplink-ac750/3_etcpasswd.png" alt="etc passwd" data-is-external-image="true"></p>
<p>The admin user has its hash on the passwd file and is easly crackable</p>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/reverse-engineering/iot-hacking/tplink-ac750/8_crack_admin_linux.png" alt="Crack Admin" data-is-external-image="true"></p>
<ul>
<li><code>admin:1234</code>¬†‚Äì&gt; root account</li>
</ul>
<p>We can guess that there is a dropbear for SSH Service because of the username but also during the boot of the device, it geneate new RSA keys.</p>
<h2 id="device-information">Device information</h2>
<p>During my enumeration I could find more precise information about the device.</p>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/reverse-engineering/iot-hacking/tplink-ac750/13_router_info.png" alt="DeviceInfo" data-is-external-image="true"></p>
<h2 id="ssid-password">SSID Password</h2>
<p>After a while I was able to locate the SSID information and retreive the passwords.</p>
<p>Here is the PATH where to find the password stored in clear text :¬†<img loading="lazy" src="https://alrikrr.github.io/posts/reverse-engineering/iot-hacking/tplink-ac750/16_location_passwords_ap.png" alt="PathPassword" data-is-external-image="true"></p>
<p>Here is the default SSID password which is¬†<code>12345678</code>, classic.<br><img loading="lazy" src="https://alrikrr.github.io/posts/reverse-engineering/iot-hacking/tplink-ac750/14_default_AP_password.png" alt="DefaultPassword" data-is-external-image="true"></p>
<p>And finally the Password of the SSID that is currently in use on the device.<br><img loading="lazy" src="https://alrikrr.github.io/posts/reverse-engineering/iot-hacking/tplink-ac750/15_inuse_AP_password.png" alt="SSIDPassword" data-is-external-image="true"></p>
<h2>Admin Panel</h2>
<p>Since I now have access to the Wifi network I can now get access to the Admin Panel but unfortunatly I need to find a way to grab the admin password !</p>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/reverse-engineering/iot-hacking/tplink-ac750/6_login_http.png" alt="SSIDPassword" data-is-external-image="true"></p>
<p>Next time i‚Äôll dig into the admin panel and find maybe a way to get inside (Hardcoded password ?)</p>
<p>See ya !</p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Firmware Reverse | D-Link - DCS-932L</title>
        <author>
            <name>AlrikRr</name>
        </author>
        <link href="https://alrikrr.github.io/firmware-reverse-or-d-link-dcs-932l/"/>
        <id>https://alrikrr.github.io/firmware-reverse-or-d-link-dcs-932l/</id>
        <media:content url="https://alrikrr.github.io/media/posts/12/firmware.jpg" medium="image" />
            <category term="IoT Hacking"/>

        <updated>2023-08-15T20:46:19-04:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://alrikrr.github.io/media/posts/12/firmware.jpg" alt="" />
                    This is actually my first firmware ‚ÄúReverse‚Äù. This post will also serve as a tutorial for myself and others !&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <p><img src="https://alrikrr.github.io/media/posts/12/firmware.jpg" class="type:primaryImage" alt="" /></p>
                <p class="alert alert-warning msg msg--warning"><strong>This is actually my first firmware ‚ÄúReverse‚Äù. This post will also serve as a tutorial for myself and others !</strong></p>
<p class="alert alert-danger msg msg--warning"><strong>For education purpose</strong></p>
<hr>
<h1 id="sources">Sources</h1>
<ul>
<li>Version :¬†<code>1.14.04</code></li>
<li>MD5 :¬†<code>b93d60f595c4736a153ca8c61d77ffc6</code></li>
<li>Download link¬†<a href="http://files.dlink.com.au/products/DCS-932L/REV_A/Firmware/">http://files.dlink.com.au/products/DCS-932L/REV_A/Firmware/</a></li>
</ul>
<p>This test we perfomed on Kali Linux VM.</p>
<h1 id="stage-1---analysis">Stage 1 - Analysis</h1>
<p>Using¬†<code>binwalk</code>¬†we can ‚Äúwalk‚Äù through the firmware and check signatures inside the binary, those signatures return known Desciption and Hex address. of what‚Äôs inside the binary.</p>
<div class="highlight">
<pre tabindex="0"><code class="language-shell hljs" data-lang="shell">binwalk dcs932l_v1.14.04.bin
</code></pre>
</div>
<p>Here is the output</p>
<div class="highlight">
<pre tabindex="0"><code class="language-shell hljs" data-lang="shell">DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
106352        0x19F70         U-Boot version string, "U-Boot 1.1.3"
106816        0x1A140         CRC32 polynomial table, little endian
124544        0x1E680         HTML document header
124890        0x1E7DA         HTML document footer
124900        0x1E7E4         HTML document header
125092        0x1E8A4         HTML document footer
125260        0x1E94C         HTML document header
125953        0x1EC01         HTML document footer
327680        0x50000         uImage header, header size: 64 bytes, header CRC: 0x88345E96, created: 2016-09-09 13:52:27, image size: 3804958 bytes, Data Address: 0x80000000, Entry Point: 0x803B8000, data CRC: 0x531E94DE, OS: Linux, CPU: MIPS, image type: OS Kernel Image, compression type: lzma, image name: "Linux Kernel Image"
327744        0x50040         LZMA compressed data, properties: 0x5D, dictionary size: 33554432 bytes, uncompressed size: 6558763 bytes
</code></pre>
</div>
<h2 id="binwalk-result">Binwalk Result</h2>
<ul>
<li><code>106352 - 0x19F70</code>¬†: U-Boot 1.1.3</li>
<li><code>327680 - 0x50000</code>¬†: Linux Kernel Image</li>
<li><code>327744 - 0x50040</code>¬†: LZMA Compress Data</li>
</ul>
<p>uImage Header at¬†<code>327680</code>¬†tell us that we can found a LInux Kerne Image in a LZMA arhcive format.</p>
<h2 id="decompress-lzma">Decompress LZMA</h2>
<p>Unpack the LZMA Archive using¬†<code>dd</code>¬†tool. We output the result inside the¬†<code>kernal.lzma</code>¬†file.</p>
<div class="highlight">
<pre tabindex="0"><code class="language-shell hljs" data-lang="shell">dd if=dcs932l_v1.14.04.bin skip=327744 bs=1 of=kernel.lzma
</code></pre>
</div>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/reverse-engineering/iot-hacking/d-link-dcs-932l/kernellzmq.jpeg" alt="kernel.lzma" data-is-external-image="true"></p>
<p>Make sure the LZMA file is well extracted</p>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/reverse-engineering/iot-hacking/d-link-dcs-932l/kernel-check.jpeg" alt="kernel.lzma.check" data-is-external-image="true"></p>
<p>Now let‚Äôs extract the LZMA achive using¬†<code>unlzma</code>¬†tool</p>
<div class="highlight">
<pre tabindex="0"><code class="language-shell hljs" data-lang="shell">unlzma -d &lt; kernel.lzma &gt; kernel
</code></pre>
</div>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/reverse-engineering/iot-hacking/d-link-dcs-932l/lzma-check.jpeg" alt="kernel.lzma.check" data-is-external-image="true"></p>
<div class="alert alert-warning"><strong>Got an error while extracting the kernel bit it seems working just fine for now , lucky me.</strong></div>
<h1 id="stage-2---kernel">Stage 2 - Kernel</h1>
<p>Now we have the kernel in our hands, let‚Äôs see what‚Äôs in there.</p>
<p>Again we use¬†<code>binwalk</code></p>
<div class="highlight">
<pre tabindex="0"><code class="language-shell hljs" data-lang="shell">DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
3145804       0x30004C        Linux kernel version 2.6.21
3175792       0x307570        SHA256 hash constants, little endian
3183312       0x3092D0        AES Inverse S-Box
3184080       0x3095D0        AES S-Box
3389960       0x33BA08        Unix path: /usr/gnemul/irix/
3392244       0x33C2F4        Unix path: /usr/lib/libc.so.1
3393940       0x33C994        Unix path: /dev/vc/0
3408260       0x340184        Copyright string: "Copyright (c) 2010 Alpha Networks Inc."
3491536       0x3546D0        Unix path: /etc/Wireless/RT2860STA/RT2860STA.dat
3573187       0x3685C3        Neighborly text, "neighbor %.2x%.2x.%.2x:%.2x:%.2x:%.2x:%.2x:%.2x lost on port %d(%s)(%s)"
3807776       0x3A1A20        CRC32 polynomial table, little endian
3811440       0x3A2870        AES S-Box
4038656       0x3DA000        LZMA compressed data, properties: 0x5D, dictionary size: 1048576 bytes, uncompressed size: 8072704 bytes
</code></pre>
</div>
<p>Another LZMA archive is visible at 4038656</p>
<h2 id="extract-unkown-lzma-archive">Extract Unkown LZMA archive</h2>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/reverse-engineering/iot-hacking/d-link-dcs-932l/unkown.jpeg" alt="kernel.lzma.check" data-is-external-image="true"></p>
<div class="highlight">
<pre tabindex="0"><code class="language-shell hljs" data-lang="shell">unlzma -d &lt; unknown.lzma &gt; unkown
</code></pre>
</div>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/reverse-engineering/iot-hacking/d-link-dcs-932l/unknown1.jpeg" alt="kernel.lzma.check" data-is-external-image="true"></p>
<p>And here we go, Here is the¬†<code>CPIO</code>¬†archive thta contain the file system of the firnware.</p>
<h2 id="cves">CVEs</h2>
<p>In the same time, the first¬†<code>binwalk</code>¬†on the kernel file give us the CVE output of the current kernel version¬†<strong><code>Linux Kernel 2.6.21 - 15 CVE</code></strong></p>
<div class="highlight">
<pre tabindex="0"><code class="language-shell hljs" data-lang="shell">1	CVE-2012-1583	399		DoS	2012-06-16	2016-08-23	5.0	None	Remote	Low	Not
2	CVE-2009-2406	119		DoS
3	CVE-2009-1389	119		DoS
4	CVE-2009-0778			DoS	2009-03-12	2020-08-28	7.1	None	Remote	Medium	Not
5	CVE-2008-4609	16		DoS	2008-10-20	2021-07-07	7.1	None	Remote	Medium	Not
6	CVE-2008-2750	20		DoS
7	CVE-2008-1669	94		Exec
8	CVE-2008-1294	20		Bypass	2008-05-02	2018-10-30	2.1	None	Local	Low	Not
9	CVE-2008-0600	94		+Priv	2008-02-12	2018-10-30	7.2	None	Local	Low	Not
10	CVE-2008-0352	119		DoS
11	CVE-2007-2876			DoS	2007-06-11	2018-10-30	6.1	None	Local
12	CVE-2007-2453				2007-06-11	2018-10-30	1.2	None	Local	High	Not
13	CVE-2007-2451			+Info	2007-05-29	2018-10-30	5.0	None	Remote	Low	Not
14	CVE-2007-2172	20			2007-04-22	2018-10-19	4.7	None	Local	Medium	Not
15	CVE-2006-6058	189		DoS
</code></pre>
</div>
<h1 id="stage-3---unpack-cpio">Stage 3 - Unpack CPIO</h1>
<p>Now let‚Äôs unpack this arhive CPIO and see if we an get the file system.</p>
<div class="highlight">
<pre tabindex="0"><code class="language-shell hljs" data-lang="shell">sudo cpio -idm --no-absolute-filenames &lt; ../unkown
</code></pre>
</div>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/reverse-engineering/iot-hacking/d-link-dcs-932l/cpiounpack.jpeg" alt="kernel.lzma.check" data-is-external-image="true"></p>
<p>The filesystem is here we can now explore it on our own</p>
<h1 id="stage-4---filesystem">Stage 4 - Filesystem</h1>
<h2 id="etc_ro">/etc_ro/</h2>
<p>Inside the¬†<code>/etc_ro/</code>¬†folder we can see custom script and a web folder application.</p>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/reverse-engineering/iot-hacking/d-link-dcs-932l/etc_ro.jpeg" alt="kernel.lzma.check" data-is-external-image="true"></p>
<p>Simple Web application and private keys auto signed for the web server</p>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/reverse-engineering/iot-hacking/d-link-dcs-932l/etc_ro2.jpeg" alt="kernel.lzma.check" data-is-external-image="true"></p>
<p>Another firmware in the WLAN folder¬†<img loading="lazy" src="https://alrikrr.github.io/posts/reverse-engineering/iot-hacking/d-link-dcs-932l/etc_ro3.jpeg" alt="kernel.lzma.check" data-is-external-image="true"></p>
<p>And then the private RSA key fo the web server</p>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/reverse-engineering/iot-hacking/d-link-dcs-932l/etc_ro4.png" alt="kernel.lzma.check" data-is-external-image="true"></p>
<h2 id="sbin">/sbin/</h2>
<p>The sbin folder seems to be more interesting since we can check the custom scripts.¬†<img loading="lazy" src="https://alrikrr.github.io/posts/reverse-engineering/iot-hacking/d-link-dcs-932l/sbin1.jpeg" alt="sbin" data-is-external-image="true"></p>
<p>First thing I see while checking the custom scripts is that the absolute path of the binaries is not mentionned, this can be used as an exploit to bypass the real binary and use a malicious one if the¬†<code>$PATH</code>¬†variable is changed.</p>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/reverse-engineering/iot-hacking/d-link-dcs-932l/sbin2.jpeg" alt="sbin" data-is-external-image="true"></p>
<h2 id="internetsh">internet.sh</h2>
<p>This script is interesting, since we can see the process of creating a new user on the system which is added directly to the¬†<code>/ect/passwd</code>.</p>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/reverse-engineering/iot-hacking/d-link-dcs-932l/sbin3.jpeg" alt="sbin" data-is-external-image="true"></p>
<p>Here is some source code for the¬†<a href="https://github.com/Nossiac/mtk-openwrt-feeds/blob/master/applications/wificonf/files/usr/bin/nvram_get">nvram_get(click-me)</a>¬†function, from¬†<code>wificonf</code>¬†package.</p>
<p>This function seems to retreive a value from a device</p>
<div class="highlight">
<pre tabindex="0"><code class="language-shell hljs" data-lang="shell">nvram_get [dev] &lt;key&gt;
</code></pre>
</div>
<p>The value 2880 seems to be a default value for the first card</p>
<div class="highlight">
<pre tabindex="0"><code class="language-shell hljs" data-lang="shell"><span class="hljs-meta">#</span><span class="bash"> <span class="hljs-keyword">else</span>, try default mapping with l1profile:</span>
<span class="hljs-meta">#</span><span class="bash">     2880  -&gt; 1st card</span>
<span class="hljs-meta">#</span><span class="bash">     rtdev -&gt; 2nd card</span>
<span class="hljs-meta">#</span><span class="bash">     wifi3 -&gt; 3rd card</span>
</code></pre>
</div>
<h2 id="storagesh">storage.sh</h2>
<p>From this script we can see a nasty¬†<code>chmod 777</code>¬†on the home directory of the current user or the ser created.</p>
<p><img loading="lazy" src="https://alrikrr.github.io/posts/reverse-engineering/iot-hacking/d-link-dcs-932l/storage.jpeg" alt="storage" data-is-external-image="true"></p>
<p>Here is the github that contains all the scripts files :¬†<a href="https://github.com/socoola/yhrouter/blob/master/user/rt2880_app/scripts/storage.sh">github-scripts</a></p>
            ]]>
        </content>
    </entry>
</feed>
