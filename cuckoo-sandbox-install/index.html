<!DOCTYPE html><html lang="en-ca"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><title>Cuckoo Sandbox - Install - AlrikRr&#x27;s Blog</title><meta name="description" content="EDIT - 03/03/2021 : I upgrade the Windows 7 install for a Windows 10. EDIT - 16/08/2023 : Didn't try this&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><script type="gdpr-blocker/Google Analytics">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
						new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
						j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
						'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
					})(window,document,'script','dataLayer','G-22SHFE01F3');</script><link rel="stylesheet" href="https://alrikrr.github.io/media/plugins/syntaxHighlighter/prism-black.css"><link rel="canonical" href="https://alrikrr.github.io/cuckoo-sandbox-install/"><link rel="alternate" type="application/atom+xml" href="https://alrikrr.github.io/feed.xml"><link rel="alternate" type="application/json" href="https://alrikrr.github.io/feed.json"><meta property="og:title" content="Cuckoo Sandbox - Install"><meta property="og:image" content="https://alrikrr.github.io/media/posts/16/cuckoo-sandbox.png"><meta property="og:image:width" content="1920"><meta property="og:image:height" content="1095"><meta property="og:site_name" content="AlrikRr's Blog"><meta property="og:description" content="EDIT - 03/03/2021 : I upgrade the Windows 7 install for a Windows 10. EDIT - 16/08/2023 : Didn't try this&hellip;"><meta property="og:url" content="https://alrikrr.github.io/cuckoo-sandbox-install/"><meta property="og:type" content="article"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@alrikrr"><meta name="twitter:title" content="Cuckoo Sandbox - Install"><meta name="twitter:description" content="EDIT - 03/03/2021 : I upgrade the Windows 7 install for a Windows 10. EDIT - 16/08/2023 : Didn't try this&hellip;"><meta name="twitter:image" content="https://alrikrr.github.io/media/posts/16/cuckoo-sandbox.png"><link rel="shortcut icon" href="https://alrikrr.github.io/media/website/android-chrome-192x192.png" type="image/x-icon"><link rel="stylesheet" href="https://alrikrr.github.io/assets/css/fontawesome-all.min.css?v=bbcde81f26378440dac4c3d195714389"><link rel="stylesheet" href="https://alrikrr.github.io/assets/css/style.css?v=9b43267d2b7457feeb36a64550d71700"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://alrikrr.github.io/cuckoo-sandbox-install/"},"headline":"Cuckoo Sandbox - Install","datePublished":"2020-07-19T21:15","dateModified":"2023-08-16T22:03","image":{"@type":"ImageObject","url":"https://alrikrr.github.io/media/posts/16/cuckoo-sandbox.png","height":1095,"width":1920},"description":"EDIT - 03/03/2021 : I upgrade the Windows 7 install for a Windows 10. EDIT - 16/08/2023 : Didn't try this&hellip;","author":{"@type":"Person","name":"AlrikRr","url":"https://alrikrr.github.io/authors/alrikrr/"},"publisher":{"@type":"Organization","name":"AlrikRr"}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript></head><body class="is-preload"><div id="wrapper"><div id="main"><div class="inner"><header id="header"><a class="logo" href="https://alrikrr.github.io/"><strong>AlrikRr&#x27;s Blog</strong></a><ul class="icons"><li><a href="https://twitter.com/AlrikRr" class="icon brands fa-twitter"><span class="label">Twitter</span></a></li><li><a href="https://www.linkedin.com/in/adrien-lasalle/" class="icon brands fa-linkedin"><span class="label">LinkedIn</span></a></li><li><a href="https://www.youtube.com/channel/UCHUrf2NqybwOFQ6tfYt3zNA" class="icon brands fa-youtube"><span class="label">YouTube</span></a></li></ul></header><article class="post"><header class="main post__header"><time datetime="2020-07-19T21:15" class="post__date">19 July 2020</time><h1>Cuckoo Sandbox - Install</h1></header><figure class="image main"><img src="https://alrikrr.github.io/media/posts/16/cuckoo-sandbox.png" srcset="https://alrikrr.github.io/media/posts/16/responsive/cuckoo-sandbox-xs.png 300w, https://alrikrr.github.io/media/posts/16/responsive/cuckoo-sandbox-sm.png 480w, https://alrikrr.github.io/media/posts/16/responsive/cuckoo-sandbox-md.png 768w, https://alrikrr.github.io/media/posts/16/responsive/cuckoo-sandbox-lg.png 1024w, https://alrikrr.github.io/media/posts/16/responsive/cuckoo-sandbox-xl.png 1360w, https://alrikrr.github.io/media/posts/16/responsive/cuckoo-sandbox-xxl.png 1600w" sizes="(max-width: 1600px) 100vw, 1600px" loading="lazy" height="1095" width="1920" alt=""></figure><div class="post__inner post__entry"><p class="msg msg--highlight"><strong>EDIT - 03/03/2021</strong> : I upgrade the Windows 7 install for a Windows 10.</p><p class="msg msg--highlight"><strong>EDIT - 16/08/2023</strong> : Didn't try this one for a while, I don't know if it still works for 2023 ! So be carefull guys !</p><p>Hello! it’s been a while since I’ve done a little tutorial on my blog!</p><p>Today we’re going to see how to install and configure cuckoo sandbox for dynamic analysis on a Windows 10 machine!</p><p class="msg msg--warning"><strong>INFO</strong> : I made this tutorial on a Ubuntu 20.04 updated machine and virtualbox 6.1. You may have version problems depending on the packages you are going to install.</p><h1 id="before-continuing">Before continuing</h1><p>Before continuing, please be aware that cuckoo’s technical documentation is very complete and can help you in case of problems. I’m not an expert, in case of bad configuration and “destruction” of your environment, I can’t be held responsible.<br>This tutorial is primarily here to serve as notes and not to spend 1 week in the cuckoo documentation.</p><p>Well, let’s get on with it!</p><hr><h1 id="user">User</h1><p>For this tutorial I created a user <code>cuckoo</code> with sudo rights to download the packages.<br>I logged into his session to do the whole installation with it.<br>Feel free to change the cuckoo user with your current user.</p><div class="highlight"><pre tabindex="0"><code class="language-bash hljs" data-lang="bash">sudo useradd cuckoo
sudo usermod -a -G vboxusers cuckoo
sudo usermod -aG sudo cuckoo
</code></pre></div><p>Also remember to put the user in the <code>vboxusers</code> group so that he has the rights to use VMs.</p><h1 id="installing-packages">Installing packages</h1><p>There are a lot of them, here is all you need to install before continuing.</p><div class="highlight"><pre tabindex="0"><code class="language-bash hljs" data-lang="bash">sudo apt update
sudo apt upgrade

sudo apt install python python3-pip python-dev libffi-dev libssl-dev
sudo apt install python-setuptools
pip3 install virtualenv
sudo apt install libjpeg-dev zlib1g-dev swig
sudo apt install mongodb
sudo apt install postgresql libpq-dev
sudo apt install virtualbox
sudo apt install tcpdump apparmor-utils
sudo apt install m2crypto

</code></pre></div><h1 id="virtualbox---vboxnet0">Virtualbox - vboxnet0</h1><p>Normally you should have the latest version of virtualbox, remember to create a host private network in the virtualbox settings and leave it as default.</p><p><img loading="lazy" src="https://alrikrr.github.io/posts/malware/malware-tutorials/cuckoo-sandbox/vboxnet0.png" alt="vboxnet0" data-is-external-image="true"></p><p>Here is what your interface should look like:</p><p><img loading="lazy" src="https://alrikrr.github.io/posts/malware/malware-tutorials/cuckoo-sandbox/ipa.png" alt="ipa" data-is-external-image="true"></p><h1 id="tcpdump">TCPDUMP</h1><p>Now we need to configure tcpdump.<br>By default it is only executable by an administrator account but it must be executable by our user without privilege elevation (sudo).</p><p>Otherwise, it’s impossible to run a network scan with cuckoo.</p><div class="highlight"><pre tabindex="0"><code class="language-bash hljs" data-lang="bash">sudo groupadd pcap
sudo usermod -a -G pcap cuckoo
sudo chgrp pcap /usr/sbin/tcpdump
sudo <span class="hljs-built_in">setcap</span> cap_net_raw,cap_net_admin=eip /usr/sbin/tcpdump
sudo aa-disable /usr/sbin/tcpdump
</code></pre></div><p>To check if everything is working properly you can run :</p><div class="highlight"><pre tabindex="0"><code class="language-bash hljs" data-lang="bash"><span class="hljs-built_in">getcap</span> /usr/sbin/tcpdump
</code></pre></div><p>Or just run <code>tcpdump</code> with your user and see if it runs without admin rights.</p><p><strong>TIPS</strong>: If you want another user to be able to run <code>tcpdump</code> without administrator rights, simply add him to the <code>pcap</code> group.</p><h1 id="cuckoo">Cuckoo</h1><h2 id="env-python">env python</h2><p>Before installing cuckoo, you need to create a python2.7 environment because cuckoo only supports python2 (yes that sucks).</p><p>For our environment, we’ll do it with <code>virtualenv</code> :</p><div class="highlight"><pre tabindex="0"><code class="language-bash hljs" data-lang="bash">virtualenv -p /usr/bin/python2.7 cuckoo-env
</code></pre></div><p>To activate your env-python and work on it, just run :</p><div class="highlight"><pre tabindex="0"><code class="language-bash hljs" data-lang="bash"><span class="hljs-built_in">source</span> cuckoo-env/bin/activate
</code></pre></div><h3 id="troubleshooting">Troubleshooting</h3><p>If you ever have problems with <code>virtualenv</code> reinstall it :</p><div class="highlight"><pre tabindex="0"><code class="language-bash hljs" data-lang="bash">sudo apt remove virtualenv
sudo apt install virtualenv
</code></pre></div><h2 id="installation-of-cuckoo">Installation of Cuckoo</h2><p>Now we are ready to install Cuckoo in our env-python2.7:</p><div class="highlight"><pre tabindex="0"><code class="language-bash hljs" data-lang="bash">pip install setutools
pip install -U cuckoo
</code></pre></div><p>Check if all cuckoo libraries have been installed without errors.</p><p>Start your first cuckoo initialization with the command :</p><div class="highlight"><pre tabindex="0"><code class="language-bash hljs" data-lang="bash">cuckoo init
</code></pre></div><p>If everything works well, it shows you the path to the cuckoo configuration files.</p><p>In my case, it' s in <code>/home/cuckoo/.cuckoo</code>.</p><h1 id="virtual-machine-windows-10">Virtual Machine Windows 10</h1><p>Cuckoo is installed, we are now going to create our virtual machine under Windows 10.</p><p>Before I manually installed my VM with virtualbox, I had done it with <code>vmcloak</code> but unfortunately it’s no longer compatible with virtualbox-6.1 so we’ll do it differently !</p><h2 id="creating-the-vm">Creating the VM</h2><p>Nothing exceptional here, just install your VM as you would normally do on virtualbox.</p><p><strong>TIPS</strong>: I recommend that you give it 2 cores in CPU and 2GB in RAM because later you will have the possibility to make a DUMP of the RAM and analyze it with <code>volatility</code> and I can assure you that a 2GB memory dump is easier to analyze than an 8GB memory dump!</p><p><strong>Counter-Tips</strong>: If you are not interested by the forensic analysis, just put all the RAM that you want !</p><p>For the network card of the machine, you have to assign the <strong>vboxnet0</strong> card, the one we created at the very beginning of the tutorial and a bridge access card.</p><p><img loading="lazy" src="https://alrikrr.github.io/posts/malware/malware-tutorials/cuckoo-sandbox/seven_vm.png" alt="seven_vm" data-is-external-image="true"></p><h2 id="vm-configuration">VM Configuration</h2><p>Once your Windows 10 system is installed, you need to configure it and install various software.</p><p>For now, you can have an internet access.</p><p>Here are the tools to install :</p><ul><li>Python2.7 <strong>Not Python3 !!</strong></li><li>adobepdf</li><li>Office</li><li>pillow ( <code>C:\Python27\python.exe -m pip install Pillow</code> used for the screenshot)</li></ul><h2 id="installation-of-the-cuckoo-agent">Installation of the cuckoo agent</h2><p>It is important to install the cuckoo agent that will be used to control the GUEST machine (windows 10).</p><p>It is a python script found in the configuration files <code>.cuckoo/agent/agent.py</code>.<br>Transfer the python script to the GUEST, change the file extension like <code>agent.pyw</code> and <strong>execute it with administrator rights</strong>.</p><p>To do that, just open <code>cmd.exe</code> with the Admin rights and then :</p><div class="highlight"><pre tabindex="0"><code class="language-batch" data-lang="batch">C:\Python27\pythonw.exe C:\Users\cuckoo\Downloads\agent.pyw
</code></pre></div><p><strong>TIPS</strong>: If you want to transfer the file from your host to your VM, you can use a Python web server ! To create a simple web server, you can se python, just run this command into the folder that contains all the files you want to share :</p><div class="highlight"><pre tabindex="0"><code class="language-bash hljs" data-lang="bash">python3 -m http.server 8888
</code></pre></div><p>Now you can access this server using your browser and type the ip and the port :</p><p><img loading="lazy" src="https://alrikrr.github.io/posts/malware/malware-tutorials/cuckoo-sandbox/web_server.png" alt="web_server" data-is-external-image="true"></p><p>To check if the script has executed correctly, open the <code>cmd.exe</code> and type :</p><pre tabindex="0"><code class="language-dos" data-lang="dos">netstat -aon
</code></pre><p> </p><p>If you see an open port on <code>0.0.0.0:8000</code> then the script has executed correctly.</p><p><strong>TIPS 2</strong>: To make the script run without the terminal, change the extension to <code>agent.pyw</code>.</p><h2 id="snapshot">Snapshot</h2><p>Once your installation is complete and everythig is working like a charm, shutdown you VM and <strong>remove the bridge network</strong> !.</p><p>For security reasons, it is necessary to set up a virtual network so that the malwares you are going to run on your sandbox cannot communicate with the machines on your home network! <strong>Remove the other network cards and keep vboxnet0</strong>, then turn your machine back on and <strong>once on the desktop</strong>, make your snapshot.</p><p><img loading="lazy" src="https://alrikrr.github.io/posts/malware/malware-tutorials/cuckoo-sandbox/vbox_rsx.png" alt="vbox_rsx" data-is-external-image="true"></p><p>Once you machine is up and your on the desktop, start the cuckoo agent with admin right and <strong>take a snapshot</strong> !</p><h1 id="cuckoo-configuration">Cuckoo Configuration</h1><p>Now that our machine is ready, we’ll set up cuckoo.</p><p>We start by downloading the community plugins with the following command:</p><div class="highlight"><pre tabindex="0"><code class="language-bash hljs" data-lang="bash">cuckoo community
</code></pre></div><p>Once that’s done we can start our configuration.</p><h2 id="virtualboxconf">virtualbox.conf</h2><p>Since we are using virtualbox, we need to modify the <code>.cuckoo/conf/virtualbox.conf</code> file.</p><p>This file will contain the configuration of our machine, I’ll show you the parameters to modify :</p><pre tabindex="0"><code class="language-conf" data-lang="conf">[virtualbox]

# headless allows not to display the VM 
# If you want to display your machine and see the actions that are performed, I advise you to use the option gui
mode = gui

path = /usr/bin/VBoxManage

interface = vboxnet0

# You can place multiple machines, here cuckoo1 is the identifier of the vm configured below in the [cuckoo1] section file, 
# If you add another machine, add a cuckoo2 and copy/paste the configuration below and rename it [cuckoo2].
machines = cuckoo1

controlports = 5000-5050

[cuckoo1]

# VM name
label = windows10

platform = windows

# Its ip address, if you did not touch the configuration of vboxnet0, it does not change and remains in 192.168.56.101
ip = 192.168.56.101

# snapshot name
snapshot = origin

# For the rest of the file just keep the default configuration.
</code></pre><h2 id="virustotal">VirusTotal</h2><p>By default, the VirusTotal addon is disable. This option is used to analyse the file that you drop into your VM for a Static analysis.</p><p>If you want to anable this option, go to <code>.cuckoo/conf/processing.conf</code> and change the <code>enabled = yes</code> into the <strong>[virustotal]</strong> section.</p><p><strong>WARNING</strong> : Cuckoo will send the file using the public API of VirusTotal, that means all the file will be accessible by everybody. Don’t use VirusTotal to analyse a confidential file.</p><h2 id="network-configuration">Network configuration</h2><p>As you can see, our machine currently has no internet connection on the <code>vboxnet0</code> card, we will set up a redirection so that it can access the internet.</p><p>In my case, the main network card of my host (the wi-fi interface) is called <code>wlp2s0</code>, change it if necessary.</p><div class="highlight"><pre tabindex="0"><code class="language-bash hljs" data-lang="bash">sudo sysctl -w net.ipv4.conf.vboxnet0.forwarding=1
sudo sysctl -w net.ipv4.conf.wlp2s0.forwarding=1

sudo iptables -t nat -A POSTROUTING -o wlp2s0 -s 192.168.56.0/24 -j MASQUERADE
sudo iptables -P FORWARD DROP
sudo iptables -A FORWARD -m state --state RELATED,ESTABLISHED -j ACCEPT
sudo iptables -A FORWARD -s 192.168.56.0/24 -j ACCEPT
</code></pre></div><p>Now your machine will have internet access even on the <code>vboxnet0</code> card.</p><h2 id="routing-cuckoo">Routing cuckoo</h2><p>You need to enable cuckoo’s routing for internet access &amp; traffic analysis.</p><p>To do this, just modify the <code>.cuckoo/conf/routing.conf</code> file and in the <code>internet</code> option put the name of your network card, here I’ll put <code>wlp2s0</code>.</p><p><img loading="lazy" src="https://alrikrr.github.io/posts/malware/malware-tutorials/cuckoo-sandbox/routing.png" alt="routing" data-is-external-image="true"></p><h2 id="mongodb">Mongodb</h2><p>To activate cuckoo’s web interface, you need to enable mongodb.</p><p>Go to the <code>.cuckoo/conf/reporting.conf</code> file on line 45 in the <code>mongodb</code> section and pass the <code>enabled</code> option to <code>yes</code> :</p><pre tabindex="0"><code class="language-conf" data-lang="conf">enabled = yes
</code></pre><h1 id="fingers-crossed">Fingers crossed</h1><p>Now that everything is set up, all we have to do is cross our fingers and run cuckoo!</p><p>To start cuckoo, you will need 3 terminals that will execute the commands in this order:</p><h2 id="terminal-1---routing">Terminal 1 - routing</h2><div class="highlight"><pre tabindex="0"><code class="language-bash hljs" data-lang="bash">cuckoo rooter --sudo --group cuckoo
</code></pre></div><h2 id="terminal-2---cuckoo">Terminal 2 - cuckoo</h2><div class="highlight"><pre tabindex="0"><code class="language-bash hljs" data-lang="bash">cuckoo -d
</code></pre></div><h2 id="terminal-3---web">Terminal 3 - Web</h2><div class="highlight"><pre tabindex="0"><code class="language-bash hljs" data-lang="bash">cuckoo web --host 127.0.0.1 --port 8080
</code></pre></div><p>And there you are, normally, you should be able to access the web interface at this address <a href="http://127.0.0.1:8080/">http://127.0.0.1:8080</a>!</p><p>If you ever encounter problems, look at the second terminal, the <code>-d</code> option allows you to display the debug mode and see what’s wrong.</p><p>If you’re stuck on an error, I advise you to look if this error hasn’t already been solved on cuckoo’s github.</p></div><footer class="post__inner post__footer"><p class="post__last-updated">This article was updated on 16 August 2023</p><div class="post__share"><h3>Share post:</h3><a href="https://twitter.com/share?url=https%3A%2F%2Falrikrr.github.io%2Fcuckoo-sandbox-install%2F&amp;via=%40AlrikRr&amp;text=Cuckoo%20Sandbox%20-%20Install" class="js-share icon brands fa-twitter" rel="nofollow noopener noreferrer"><span class="label">Twitter</span> </a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Falrikrr.github.io%2Fcuckoo-sandbox-install%2F" class="js-share icon brands fa-linkedin" rel="nofollow noopener noreferrer"><span class="label">LinkedIn</span> </a><a href="https://api.whatsapp.com/send?text=Cuckoo%20Sandbox%20-%20Install https%3A%2F%2Falrikrr.github.io%2Fcuckoo-sandbox-install%2F" class="js-share icon brands fa-whatsapp" rel="nofollow noopener noreferrer"><span class="label">WhatsApp</span></a></div><div class="post__tag"><ul><li><strong>Tagged in:</strong></li><li><a href="https://alrikrr.github.io/tags/malware/">Malware</a></li></ul></div><div class="post__bio"><img src="https://alrikrr.github.io/media/website/1675479739617.jpeg" loading="lazy" height="697" width="697" alt="AlrikRr"><div><h3><a href="https://alrikrr.github.io/authors/alrikrr/" class="invert" rel="author">AlrikRr</a></h3><p>Former Firefighter 🚒, I decided to follow my passion in computer security and pursue my studies in this domain. After a few moves all over France 🇫🇷 and 4 months of study in Warsaw, Poland, I was able to join Canada 🇨🇦 and start a new life!<br>📨 Feel free to contact me to talk cyber over coffee ☕️ !</p><ul><li class="align-left">My Github Account: <a href="https://github.com/AlrikRr" title="My Github" target="_blank" rel="noopener">AlrikRr</a></li><li class="align-left">My Twitter Account: <a href="https://twitter.com/AlrikRr" title="My Twitter" target="_blank" rel="noopener">AlrikRr</a></li><li class="align-left">Infosec.Exchange: <a href="https://infosec.exchange/@AlrikRr" title="My Mastodon Account" target="_blank" rel="noopener">@AlrikRr</a></li></ul></div></div></footer></article></div></div><div id="sidebar"><div class="inner"><nav id="menu"><header class="major"><h2>Menu</h2></header><ul><li><a href="https://alrikrr.github.io/" target="_self">Home 🏠</a></li><li><a href="https://alrikrr.github.io/authors/alrikrr/" target="_self">About me 👺</a></li><li class="has-submenu"><a href="https://alrikrr.github.io/tags/" target="_self" aria-haspopup="true" class="opener">Categories 🗂️</a><ul class="submenu level-2" aria-hidden="true"><li><a href="https://alrikrr.github.io/tags/" target="_self">All</a></li><li><a href="https://alrikrr.github.io/tags/updates/" target="_self">Personal Updates</a></li><li><a href="https://alrikrr.github.io/tags/flipperzero/" target="_self">FlipperZero</a></li><li><a href="https://alrikrr.github.io/tags/8-bits-computer/" target="_self">8 Bits Computer</a></li><li><a href="https://alrikrr.github.io/tags/iot-hacking/" target="_self">IoT Hacking</a></li><li><a href="https://alrikrr.github.io/tags/reverse-engineering/" target="_self">Reverse Engineering</a></li><li><a href="https://alrikrr.github.io/tags/malware/" target="_self">Malware</a></li><li><a href="https://alrikrr.github.io/tags/raspberrypi/" target="_self">RaspberryPi</a></li><li><a href="https://alrikrr.github.io/tags/pentesting/" target="_self">Pentesting</a></li><li><a href="https://alrikrr.github.io/tags/write-up/" target="_self">Write Up</a></li></ul></li><li class="has-submenu"><span aria-haspopup="true" class="opener">Projects 🚧</span><ul class="submenu level-2" aria-hidden="true"><li><a href="https://github.com/AlrikRr/Cisco-Smart-Exploit" target="_blank">Cisco-Smart-Exploit</a></li><li><a href="https://github.com/AlrikRr/Forensic-Extract" target="_blank">Forensic-Extract</a></li><li><a href="https://github.com/AlrikRr/USBGuardian" target="_self">USBGuardian (fork)</a></li><li><a href="https://github.com/AlrikRr/DFIR-ExtracTux" target="_blank">DFIR-Extractux</a></li></ul></li><li><a href="https://www.buymeacoffee.com/AlrikRr" target="_blank">Buy me a beer 🍺</a></li></ul></nav><section><header class="major"><h2>Get in touch</h2></header><p>📨 Feel free to contact me to talk cyber over coffee ☕️ !<br><br>=== Area of expertise ===<br>📍 Web Application Pentest (OWASP)<br>📍 Internal Active Directory &amp; SCADA Pentest<br>📍 Pentest Cloud Azure<br>📍 Python &amp; PowerShell development<br>📍 Malware Analysis</p><ul class="contact"><li class="icon solid fa-envelope">adrienlasalle[dot]pro[at]gmail[dot]com</li><li class="icon solid fa-home">Montréal, Qc 🇨🇦</li></ul></section><footer id="footer"><p class="copyright">© AlrikRr 2023 - All rights reserved</p></footer></div></div></div><script src="https://alrikrr.github.io/assets/js/jquery.min.js?v=7c14a783dfeb3d238ccd3edd840d82ee"></script><script src="https://alrikrr.github.io/assets/js/browser.min.js?v=c07298dd19048a8a69ad97e754dfe8d0"></script><script src="https://alrikrr.github.io/assets/js/breakpoints.min.js?v=81a479eb099e3b187613943b085923b8"></script><script src="https://alrikrr.github.io/assets/js/util.min.js?v=cbdaf7c20ac2883c77ae23acfbabd47e"></script><script src="https://alrikrr.github.io/assets/js/main.min.js?v=08add7f6d435054ad38ec38d7cf8be40"></script><script>var images=document.querySelectorAll("img[loading]");for(var i=0;i<images.length;i++){if(images[i].complete){images[i].classList.add("is-loaded")}else{images[i].addEventListener("load",function(){this.classList.add("is-loaded")},false)}};</script><script defer="defer" src="https://alrikrr.github.io/media/plugins/syntaxHighlighter/prism.js"></script><script defer="defer" src="https://alrikrr.github.io/media/plugins/syntaxHighlighter/prism-line-numbers.min.js"></script><script defer="defer" src="https://alrikrr.github.io/media/plugins/syntaxHighlighter/clipboard.min.js"></script><script defer="defer" src="https://alrikrr.github.io/media/plugins/syntaxHighlighter/prism-copy-to-clipboard.min.js"></script><div class="pcb" data-behaviour="badge" data-behaviour-link="#cookie-settings" data-revision="1" data-config-ttl="90" data-debug-mode="false"><div role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="pcb-title" aria-describedby="pcb-txt" class="pcb__banner"><div class="pcb__inner"><div id="pcb-title" role="heading" aria-level="2" class="pcb__title">This website uses cookies</div><div id="pcb-txt" class="pcb__txt">Select which cookies to opt-in to via the checkboxes below; our website uses cookies to examine site traffic and user activity while on our site, for marketing, and to provide social media functionality. <a href="#not-specified">More details...</a></div><div class="pcb__buttons"><button type="button" class="pcb__btn pcb__btn--link pcb__btn--configure" aria-haspopup="dialog">Manage preferences</button> <button type="button" class="pcb__btn pcb__btn--reject">Reject</button> <button type="button" class="pcb__btn pcb__btn--solid pcb__btn--accept">Accept all</button></div></div></div><div class="pcb__popup" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="pcb-popup-title"><div class="pcb__popup__wrapper"><div class="pcb__inner pcb__popup__inner"><div class="pcb__popup__heading"><div id="pcb-popup-title" role="heading" aria-level="2" class="pcb__title">Cookie settings</div><button class="pcb__popup__close" aria-label="Close"></button></div><div class="pcb__popup__content"><div class="pcb__txt pcb__popup__txt">We use cookies to enhance your browsing experience, serve personalized ads or content, and analyze our traffic. By clicking "Accept All", you consent to our use of cookies. <a href="#not-specified">More details...</a></div><ul class="pcb__groups"><li class="pcb__group"><details><summary class="pcb__group__title no-desc">Required</summary></details><div class="pcb__popup__switch is-checked"><input type="checkbox" data-group-name="" id="pcb-group-0" checked="checked"> <label for="pcb-group-0">Required</label></div></li></ul></div><div class="pcb__buttons pcb__popup__buttons"><button type="button" class="pcb__btn pcb__btn--solid pcb__btn--accept">Accept all</button> <button type="button" class="pcb__btn pcb__btn--reject">Reject all</button> <button type="button" class="pcb__btn pcb__btn--save">Save settings</button></div></div></div></div><div class="pcb__overlay" aria-hidden="true"></div><button class="pcb__badge" aria-label="Cookie Policy" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" width="40" height="40" viewBox="0 0 23 23" fill="currentColor"><path d="M21.41 12.71c-.08-.01-.15 0-.22 0h-.03c-.03 0-.05 0-.08.01-.07 0-.13.01-.19.04-.52.21-1.44.19-2.02-.22-.44-.31-.65-.83-.62-1.53a.758.758 0 0 0-.27-.61.73.73 0 0 0-.65-.14c-1.98.51-3.49.23-4.26-.78-.82-1.08-.73-2.89.24-4.49.14-.23.14-.52 0-.75a.756.756 0 0 0-.67-.36c-.64.03-1.11-.1-1.31-.35-.19-.26-.13-.71-.01-1.29.04-.18.06-.38.03-.59-.05-.4-.4-.7-.81-.66C5.1 1.54 1 6.04 1 11.48 1 17.28 5.75 22 11.6 22c5.02 0 9.39-3.54 10.39-8.42.08-.4-.18-.78-.58-.87Zm-9.81 7.82c-5.03 0-9.12-4.06-9.12-9.06 0-4.34 3.05-8 7.25-8.86-.08.7.05 1.33.42 1.81.24.32.66.67 1.38.84-.76 1.86-.65 3.78.36 5.11.61.81 2.03 2 4.95 1.51.18.96.71 1.54 1.18 1.87.62.43 1.38.62 2.1.62.05 0 .09 0 .13-.01-1.23 3.64-4.7 6.18-8.64 6.18ZM13 17c0 .55-.45 1-1 1s-1-.45-1-1 .45-1 1-1 1 .45 1 1Zm5.29-12.3a.99.99 0 0 1-.29-.71c0-.55.45-.99 1-.99a1 1 0 0 1 .71.3c.19.19.29.44.29.71 0 .55-.45.99-1 .99a1 1 0 0 1-.71-.3ZM9 13.5c0 .83-.67 1.5-1.5 1.5S6 14.33 6 13.5 6.67 12 7.5 12s1.5.67 1.5 1.5Zm3.25.81a.744.744 0 0 1-.06-1.05c.28-.32.75-.34 1.05-.06.31.28.33.75.05 1.06-.15.16-.35.25-.56.25-.18 0-.36-.06-.5-.19ZM8.68 7.26c.41.37.44 1 .07 1.41-.2.22-.47.33-.75.33a.96.96 0 0 1-.67-.26c-.41-.37-.44-1-.07-1.41.37-.42 1-.45 1.41-.08Zm11.48 1.88c.18-.19.52-.19.7 0 .05.04.09.1.11.16.03.06.04.12.04.19 0 .13-.05.26-.15.35-.09.1-.22.15-.35.15s-.26-.05-.35-.15a.355.355 0 0 1-.11-.16.433.433 0 0 1-.04-.19c0-.13.05-.26.15-.35Zm-4.93-1.86a.75.75 0 1 1 1.059-1.06.75.75 0 0 1-1.059 1.06Z"/></svg></button></div><script>(function(win) {
    if (!document.querySelector('.pcb')) {
        return;
    }

    var cbConfig = {
        behaviour: document.querySelector('.pcb').getAttribute('data-behaviour'),
        behaviourLink: document.querySelector('.pcb').getAttribute('data-behaviour-link'),
        revision: document.querySelector('.pcb').getAttribute('data-revision'),
        configTTL: parseInt(document.querySelector('.pcb').getAttribute('data-config-ttl'), 10),
        debugMode: document.querySelector('.pcb').getAttribute('data-debug-mode') === 'true',
        initialState: null,
        previouslyAccepted: []
    };

    var cbUI = {
        wrapper: document.querySelector('.pcb'),
        banner: {
            element: null,
            btnAccept: null,
            btnReject: null,
            btnConfigure: null
        },
        popup: {
            element: null,
            btnClose: null,
            btnSave: null,
            btnAccept: null,
            btnReject: null,
            checkboxes: null,
        },
        overlay: null,
        badge: null,
        blockedScripts: document.querySelectorAll('script[type^="gdpr-blocker/"]'),
        triggerLinks: cbConfig.behaviourLink ? document.querySelectorAll('a[href*="' + cbConfig.behaviourLink + '"]') : null
    };

    function initUI () {
        // setup banner elements
        cbUI.banner.element = cbUI.wrapper.querySelector('.pcb__banner');
        cbUI.banner.btnAccept = cbUI.banner.element.querySelector('.pcb__btn--accept');
        cbUI.banner.btnReject = cbUI.banner.element.querySelector('.pcb__btn--reject');
        cbUI.banner.btnConfigure = cbUI.banner.element.querySelector('.pcb__btn--configure');

        // setup popup elements
        if (cbUI.wrapper.querySelector('.pcb__popup')) {
            cbUI.popup.element = cbUI.wrapper.querySelector('.pcb__popup');
            cbUI.popup.btnClose = cbUI.wrapper.querySelector('.pcb__popup__close');
            cbUI.popup.btnSave = cbUI.popup.element.querySelector('.pcb__btn--save');
            cbUI.popup.btnAccept = cbUI.popup.element.querySelector('.pcb__btn--accept');
            cbUI.popup.btnReject = cbUI.popup.element.querySelector('.pcb__btn--reject');
            cbUI.popup.checkboxes = cbUI.popup.element.querySelector('input[type="checkbox"]');
            // setup overlay
            cbUI.overlay = cbUI.wrapper.querySelector('.pcb__overlay');
        }

        cbUI.badge = cbUI.wrapper.querySelector('.pcb__badge');

        if (cbConfig.behaviour.indexOf('link') > -1) {
            for (var i = 0; i < cbUI.triggerLinks.length; i++) {
                cbUI.triggerLinks[i].addEventListener('click', function(e) {
                    e.preventDefault();
                    showBannerOrPopup();
                });
            }
        }
    }

    function initState () {
        var lsKeyName = getConfigName();
        var currentConfig = localStorage.getItem(lsKeyName);
        var configIsFresh = checkIfConfigIsFresh();

        if (!configIsFresh || currentConfig === null) {
            if (cbConfig.debugMode) {
                console.log('🍪 Config not found, or configuration expired');
            }

            showBanner();
        } else if (typeof currentConfig === 'string') {
            if (cbConfig.debugMode) {
                console.log('🍪 Config founded');
            }

            showBadge();

            if (cbUI.popup.element) {
                var allowedGroups = currentConfig.split(',');
                var checkedCheckboxes = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');

                for (var j = 0; j < checkedCheckboxes.length; j++) {
                    var name = checkedCheckboxes[j].getAttribute('data-group-name');

                    if (name && name !== '-' && allowedGroups.indexOf(name) === -1) {
                        checkedCheckboxes[j].checked = false;
                    }
                }

                for (var i = 0; i < allowedGroups.length; i++) {
                    var checkbox = cbUI.popup.element.querySelector('input[type="checkbox"][data-group-name="' + allowedGroups[i] + '"]');

                    if (checkbox) {
                        checkbox.checked = true;
                    }

                    allowCookieGroup(allowedGroups[i]);
                }
            }
        }

        setTimeout(function () {
            cbConfig.initialState = getInitialStateOfConsents();
        }, 0);
    }

    function checkIfConfigIsFresh () {
        var lastConfigSave = localStorage.getItem('publii-gdpr-cookies-config-save-date');

        if (lastConfigSave === null) {
            return false;
        }

        lastConfigSave = parseInt(lastConfigSave, 10);

        if (lastConfigSave === 0) {
            return true;
        }

        if (+new Date() - lastConfigSave < cbConfig.configTTL * 24 * 60 * 60 * 1000) {
            return true;
        }

        return false;
    }

    function initBannerEvents () {
        cbUI.banner.btnAccept.addEventListener('click', function (e) {
            e.preventDefault();
            acceptAllCookies('banner');
            showBadge();
        }, false);

        if (cbUI.banner.btnReject) {
            cbUI.banner.btnReject.addEventListener('click', function (e) {
                e.preventDefault();
                rejectAllCookies();
                showBadge();
            }, false);
        }

        if (cbUI.banner.btnConfigure) {
            cbUI.banner.btnConfigure.addEventListener('click', function (e) {
                e.preventDefault();
                hideBanner();
                showAdvancedPopup();
                showBadge();
            }, false);
        }
    }

    function initPopupEvents () {
        if (!cbUI.popup.element) {
            return;
        }

        cbUI.overlay.addEventListener('click', function (e) {
            hideAdvancedPopup();
        }, false);

        cbUI.popup.element.addEventListener('click', function (e) {
            e.stopPropagation();
        }, false);

        cbUI.popup.btnAccept.addEventListener('click', function (e) {
            e.preventDefault();
            acceptAllCookies('popup');
        }, false);

        cbUI.popup.btnReject.addEventListener('click', function (e) {
            e.preventDefault();
            rejectAllCookies();
        }, false);

        cbUI.popup.btnSave.addEventListener('click', function (e) {
            e.preventDefault();
            saveConfiguration();
        }, false);

        cbUI.popup.btnClose.addEventListener('click', function (e) {
            e.preventDefault();
            hideAdvancedPopup();
        }, false);
    }

    function initBadgeEvents () {
        if (!cbUI.badge) {
            return;
        }

        cbUI.badge.addEventListener('click', function (e) {
            showBannerOrPopup();
        }, false);
    }

    initUI();
    initState();
    initBannerEvents();
    initPopupEvents();
    initBadgeEvents();

    /**
     * API
     */
    function addScript (src, inline) {
        var newScript = document.createElement('script');

        if (src) {
            newScript.setAttribute('src', src);
        }

        if (inline) {
            newScript.text = inline;
        }

        document.body.appendChild(newScript);
    }

    function allowCookieGroup (allowedGroup) {
        var scripts = document.querySelectorAll('script[type="gdpr-blocker/' + allowedGroup + '"]');
        cbConfig.previouslyAccepted.push(allowedGroup);
    
        for (var j = 0; j < scripts.length; j++) {
            addScript(scripts[j].src, scripts[j].text);
        }

        var groupEvent = new Event('publii-cookie-banner-unblock-' + allowedGroup);
        document.body.dispatchEvent(groupEvent);
        unlockEmbeds(allowedGroup);

        if (cbConfig.debugMode) {
            console.log('🍪 Allowed group: ' + allowedGroup);
        }
    }

    function showBannerOrPopup () {
        if (cbUI.popup.element) {
            showAdvancedPopup();
        } else {
            showBanner();
        }
    }

    function showAdvancedPopup () {
        cbUI.popup.element.classList.add('is-visible');
        cbUI.overlay.classList.add('is-visible');
        cbUI.popup.element.setAttribute('aria-hidden', 'false');
        cbUI.overlay.setAttribute('aria-hidden', 'false');
    }

    function hideAdvancedPopup () {
        cbUI.popup.element.classList.remove('is-visible');
        cbUI.overlay.classList.remove('is-visible');
        cbUI.popup.element.setAttribute('aria-hidden', 'true');
        cbUI.overlay.setAttribute('aria-hidden', 'true');
    }

    function showBanner () {
        cbUI.banner.element.classList.add('is-visible');
        cbUI.banner.element.setAttribute('aria-hidden', 'false');
    }

    function hideBanner () {
        cbUI.banner.element.classList.remove('is-visible');
        cbUI.banner.element.setAttribute('aria-hidden', 'true');
    }

    function showBadge () {
        if (!cbUI.badge) {
            return;
        }

        cbUI.badge.classList.add('is-visible');
        cbUI.badge.setAttribute('aria-hidden', 'false');
    }

    function getConfigName () {
        var lsKeyName = 'publii-gdpr-allowed-cookies';

        if (cbConfig.revision) {
            lsKeyName = lsKeyName + '-v' + parseInt(cbConfig.revision, 10);
        }

        return lsKeyName;
    }

    function storeConfiguration (allowedGroups) {
        var lsKeyName = getConfigName();
        var dataToStore = allowedGroups.join(',');
        localStorage.setItem(lsKeyName, dataToStore);

        if (cbConfig.configTTL === 0) {
            localStorage.setItem('publii-gdpr-cookies-config-save-date', 0);

            if (cbConfig.debugMode) {
                console.log('🍪 Store never expiring configuration');
            }
        } else {
            localStorage.setItem('publii-gdpr-cookies-config-save-date', +new Date());
        }
    }

    function getInitialStateOfConsents () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        if (cbConfig.debugMode) {
            console.log('🍪 Initial state: ' + groups.join(', '));
        }

        return groups;
    }

    function getCurrentStateOfConsents () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        if (cbConfig.debugMode) {
            console.log('🍪 State to save: ' + groups.join(', '));
        }

        return groups;
    }

    function getAllGroups () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        return groups;
    }

    function acceptAllCookies (source) {
        var groupsToAccept = getAllGroups();
        storeConfiguration(groupsToAccept);

        for (var i = 0; i < groupsToAccept.length; i++) {
            var group = groupsToAccept[i];

            if (cbConfig.initialState.indexOf(group) > -1 || cbConfig.previouslyAccepted.indexOf(group) > -1) {
                if (cbConfig.debugMode) {
                    console.log('🍪 Skip previously activated group: ' + group);
                }

                continue;
            }

            allowCookieGroup(group);
        }

        if (cbUI.popup.element) {
            var checkboxesToCheck = cbUI.popup.element.querySelectorAll('input[type="checkbox"]');

            for (var j = 0; j < checkboxesToCheck.length; j++) {
                checkboxesToCheck[j].checked = true;
            }
        }

        if (cbConfig.debugMode) {
            console.log('🍪 Accept all cookies: ', groupsToAccept.join(', '));
        }

        if (source === 'popup') {
            hideAdvancedPopup();
        } else if (source === 'banner') {
            hideBanner();
        }
    }

    function rejectAllCookies () {
        if (cbConfig.debugMode) {
            console.log('🍪 Reject all cookies');
        }

        storeConfiguration([]);
        setTimeout(function () {
            window.location.reload();
        }, 100);
    }

    function saveConfiguration () {
        var groupsToAccept = getCurrentStateOfConsents();
        storeConfiguration(groupsToAccept);

        if (cbConfig.debugMode) {
            console.log('🍪 Save new config: ', groupsToAccept.join(', '));
        }

        if (reloadIsNeeded(groupsToAccept)) {
            setTimeout(function () {
                window.location.reload();
            }, 100);
            return;
        }

        for (var i = 0; i < groupsToAccept.length; i++) {
            var group = groupsToAccept[i];

            if (cbConfig.initialState.indexOf(group) > -1 || cbConfig.previouslyAccepted.indexOf(group) > -1) {
                if (cbConfig.debugMode) {
                    console.log('🍪 Skip previously activated group: ' + group);
                }

                continue;
            }

            allowCookieGroup(group);
        }

        hideAdvancedPopup();
    }

    function reloadIsNeeded (groupsToAccept) {
        // check if user rejected consent for initial groups
        var initialGroups = cbConfig.initialState;
        var previouslyAcceptedGroups = cbConfig.previouslyAccepted;
        var groupsToCheck = initialGroups.concat(previouslyAcceptedGroups);

        for (var i = 0; i < groupsToCheck.length; i++) {
            var groupToCheck = groupsToCheck[i];

            if (groupsToAccept.indexOf(groupToCheck) === -1) {
                if (cbConfig.debugMode) {
                    console.log('🍪 Reload is needed due lack of: ', groupToCheck);
                }

                return true;
            }
        }

        return false;
    }

    function unlockEmbeds (cookieGroup) {
        var iframesToUnlock = document.querySelectorAll('.pec-wrapper[data-consent-group-id="' + cookieGroup + '"]');

        for (var i = 0; i < iframesToUnlock.length; i++) {
            var iframeWrapper = iframesToUnlock[i];
            iframeWrapper.querySelector('.pec-overlay').classList.remove('is-active');
            iframeWrapper.querySelector('.pec-overlay').setAttribute('aria-hidden', 'true');
            var iframe = iframeWrapper.querySelector('iframe');
            iframe.setAttribute('src', iframe.getAttribute('data-consent-src'));
        }
    }

    win.publiiEmbedConsentGiven = function (cookieGroup) {
        // it will unlock embeds
        allowCookieGroup(cookieGroup);

        var checkbox = cbUI.popup.element.querySelector('input[type="checkbox"][data-group-name="' + cookieGroup + '"]');

        if (checkbox) {
            checkbox.checked = true;
        }

        var groupsToAccept = getCurrentStateOfConsents();
        storeConfiguration(groupsToAccept);

        if (cbConfig.debugMode) {
            console.log('🍪 Save new config: ', groupsToAccept.join(', '));
        }
    }
})(window);</script></body></html>